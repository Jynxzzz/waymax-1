<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" /><link rel="next" title="waymax.datatypes.action" href="action/index.html" /><link rel="prev" title="waymax.dataloader.womd_utils" href="../dataloader/womd_utils/index.html" />

    <link rel="shortcut icon" href="https://waymo.com/favicon.png"/><!-- Generated with Sphinx 6.2.1 and Furo 2023.09.10 -->
        <title>waymax.datatypes - Waymax documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?digest=369552022d0b975c8e74270ce6eabe0fb7978f24" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Waymax  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  
  
  <span class="sidebar-brand-text">Waymax  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started.html">Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../agents/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.agents</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of waymax.agents</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../agents/actor_core/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.agents.actor_core</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/agent_builder/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.agents.agent_builder</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/constant_speed/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.agents.constant_speed</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/expert/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.agents.expert</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/sim_agent/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.agents.sim_agent</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/waypoint_following_agent/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.agents.waypoint_following_agent</span></code></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../dataloader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.dataloader</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of waymax.dataloader</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../dataloader/dataloader_utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.dataloader.dataloader_utils</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../dataloader/womd_dataloader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.dataloader.womd_dataloader</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../dataloader/womd_factories/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.dataloader.womd_factories</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../dataloader/womd_factories_internal/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.dataloader.womd_factories_internal</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../dataloader/womd_utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.dataloader.womd_utils</span></code></a></li>
</ul>
</li>
<li class="toctree-l1 current has-children current-page"><a class="current reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes</span></code></a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of waymax.datatypes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="action/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes.action</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="array/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes.array</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="constant/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes.constant</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="object_state/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes.object_state</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="observation/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes.observation</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="operations/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes.operations</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="roadgraph/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes.roadgraph</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="route/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes.route</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="simulator_state/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes.simulator_state</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="traffic_lights/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes.traffic_lights</span></code></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../env/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.env</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of waymax.env</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../env/wrappers/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.env.wrappers</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of waymax.env.wrappers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../env/wrappers/brax_wrapper/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.env.wrappers.brax_wrapper</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../env/wrappers/dm_env_wrapper/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.env.wrappers.dm_env_wrapper</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../env/abstract_environment/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.env.abstract_environment</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../env/base_environment/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.env.base_environment</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../env/errors/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.env.errors</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../env/planning_agent_environment/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.env.planning_agent_environment</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../env/rollout/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.env.rollout</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../env/typedefs/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.env.typedefs</span></code></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../metrics/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.metrics</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of waymax.metrics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../metrics/abstract_metric/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.metrics.abstract_metric</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics/comfort/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.metrics.comfort</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics/imitation/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.metrics.imitation</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics/metric_factory/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.metrics.metric_factory</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics/overlap/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.metrics.overlap</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics/roadgraph/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.metrics.roadgraph</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics/route/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.metrics.route</span></code></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../rewards/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.rewards</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of waymax.rewards</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../rewards/abstract_reward_function/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.rewards.abstract_reward_function</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../rewards/linear_combination_reward/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.rewards.linear_combination_reward</span></code></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.utils</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of waymax.utils</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../utils/geometry/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.utils.geometry</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../utils/test_utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.utils.test_utils</span></code></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../visualization/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.visualization</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of waymax.visualization</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../visualization/color/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.visualization.color</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualization/utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.visualization.utils</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualization/viz/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.visualization.viz</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../config/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.config</span></code></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Further Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../genindex.html">Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../py-modindex.html">Module Index</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="module-waymax.datatypes">
<span id="waymax-datatypes"></span><h1><a class="reference internal" href="#module-waymax.datatypes" title="waymax.datatypes"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes</span></code></a><a class="headerlink" href="#module-waymax.datatypes" title="Permalink to this heading">#</a></h1>
<p>Data structures and helper operations for Waymax.</p>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">#</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="action/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes.action</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="array/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes.array</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="constant/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes.constant</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="object_state/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes.object_state</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="observation/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes.observation</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="operations/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes.operations</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="roadgraph/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes.roadgraph</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="route/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes.route</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="simulator_state/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes.simulator_state</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="traffic_lights/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes.traffic_lights</span></code></a></li>
</ul>
</div>
</section>
<section id="package-contents">
<h2>Package Contents<a class="headerlink" href="#package-contents" title="Permalink to this heading">#</a></h2>
<section id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Permalink to this heading">#</a></h3>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#waymax.datatypes.Action" title="waymax.datatypes.Action"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Action</span></code></a></p></td>
<td><p>Raw actions tensor and validity mask.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#waymax.datatypes.TrajectoryUpdate" title="waymax.datatypes.TrajectoryUpdate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TrajectoryUpdate</span></code></a></p></td>
<td><p>A datastructure holding the controllable parts of a Trajectory.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#waymax.datatypes.MaskedArray" title="waymax.datatypes.MaskedArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MaskedArray</span></code></a></p></td>
<td><p>A dataclass holding values and a validity mask.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#waymax.datatypes.ObjectMetadata" title="waymax.datatypes.ObjectMetadata"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ObjectMetadata</span></code></a></p></td>
<td><p>Time-independent object metadata.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#waymax.datatypes.ObjectTypeIds" title="waymax.datatypes.ObjectTypeIds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ObjectTypeIds</span></code></a></p></td>
<td><p>Ids for different map elements to be mapped into a tensor.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#waymax.datatypes.Trajectory" title="waymax.datatypes.Trajectory"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Trajectory</span></code></a></p></td>
<td><p>Data structure representing a trajectory.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#waymax.datatypes.ObjectPose2D" title="waymax.datatypes.ObjectPose2D"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ObjectPose2D</span></code></a></p></td>
<td><p>Object 2D pose that can be used for coordinate transformation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#waymax.datatypes.Observation" title="waymax.datatypes.Observation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Observation</span></code></a></p></td>
<td><p>Observation at a single simulation step.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#waymax.datatypes.MapElementIds" title="waymax.datatypes.MapElementIds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MapElementIds</span></code></a></p></td>
<td><p>Ids for different map elements to be mapped into a tensor.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#waymax.datatypes.RoadgraphPoints" title="waymax.datatypes.RoadgraphPoints"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RoadgraphPoints</span></code></a></p></td>
<td><p>Data structure representing roadgraph points.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#waymax.datatypes.Paths" title="waymax.datatypes.Paths"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Paths</span></code></a></p></td>
<td><p>Data structure for a set of paths represented by roadgraph points.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#waymax.datatypes.SimulatorState" title="waymax.datatypes.SimulatorState"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SimulatorState</span></code></a></p></td>
<td><p>A dataclass holding the simulator state, all data in global coordinates.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#waymax.datatypes.TrafficLights" title="waymax.datatypes.TrafficLights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TrafficLights</span></code></a></p></td>
<td><p>Data structure representing the dynamic traffic light state information.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#waymax.datatypes.TrafficLightStates" title="waymax.datatypes.TrafficLightStates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TrafficLightStates</span></code></a></p></td>
<td><p>Represents the integer values for all Traffic Light State values.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Permalink to this heading">#</a></h3>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#waymax.datatypes.fill_invalid_trajectory" title="waymax.datatypes.fill_invalid_trajectory"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fill_invalid_trajectory</span></code></a>(→ Trajectory)</p></td>
<td><p>Fills a trajectory with invalid values.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#waymax.datatypes.observation_from_state" title="waymax.datatypes.observation_from_state"><code class="xref py py-obj docutils literal notranslate"><span class="pre">observation_from_state</span></code></a>(→ Observation)</p></td>
<td><p>Constructs Observation from SimulatorState for all agents (jit-able).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#waymax.datatypes.sdc_observation_from_state" title="waymax.datatypes.sdc_observation_from_state"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sdc_observation_from_state</span></code></a>(→ Observation)</p></td>
<td><p>Constructs Observation from SimulatorState for SDC only (jit-able).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#waymax.datatypes.transform_observation" title="waymax.datatypes.transform_observation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transform_observation</span></code></a>(→ Observation)</p></td>
<td><p>Transforms a Observation into coordinates specified by pose2d.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#waymax.datatypes.transform_roadgraph_points" title="waymax.datatypes.transform_roadgraph_points"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transform_roadgraph_points</span></code></a>(...)</p></td>
<td><p>Transform a RoadgraphPoints into coordinates specified by pose2d.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#waymax.datatypes.transform_traffic_lights" title="waymax.datatypes.transform_traffic_lights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transform_traffic_lights</span></code></a>(...)</p></td>
<td><p>Transforms a TrafficLightStates into coordinates specified by pose2d.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#waymax.datatypes.transform_trajectory" title="waymax.datatypes.transform_trajectory"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transform_trajectory</span></code></a>(...)</p></td>
<td><p>Transforms a Trajectory into coordinates specified by pose2d.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#waymax.datatypes.compare_all_leaf_nodes" title="waymax.datatypes.compare_all_leaf_nodes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compare_all_leaf_nodes</span></code></a>(→ bool)</p></td>
<td><p>Checks if all leaf nodes are consistent via compare_func.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#waymax.datatypes.dynamic_index" title="waymax.datatypes.dynamic_index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dynamic_index</span></code></a>(→ PyTree)</p></td>
<td><p>Wraps dynamic_index_in_dim on a PyTree.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#waymax.datatypes.dynamic_slice" title="waymax.datatypes.dynamic_slice"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dynamic_slice</span></code></a>(→ PyTree)</p></td>
<td><p>Wraps dynamic_slice_in_dim on a PyTree.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#waymax.datatypes.make_invalid_data" title="waymax.datatypes.make_invalid_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_invalid_data</span></code></a>(→ jax.Array)</p></td>
<td><p>Returns a tensor of invalid values with identical shape to data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#waymax.datatypes.masked_mean" title="waymax.datatypes.masked_mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">masked_mean</span></code></a>(→ jax.Array)</p></td>
<td><p>Calculates the mean of the array removing invalid values.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#waymax.datatypes.select_by_onehot" title="waymax.datatypes.select_by_onehot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">select_by_onehot</span></code></a>(→ PyTree)</p></td>
<td><p>Selects data using a one-hot vector.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#waymax.datatypes.update_by_mask" title="waymax.datatypes.update_by_mask"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_by_mask</span></code></a>(→ PyTree)</p></td>
<td><p>Updates inputs by updates (with same struct) for masked values.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#waymax.datatypes.update_by_slice_in_dim" title="waymax.datatypes.update_by_slice_in_dim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_by_slice_in_dim</span></code></a>(→ PyTree)</p></td>
<td><p>Updates a slice in inputs using slices from updates.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#waymax.datatypes.filter_topk_roadgraph_points" title="waymax.datatypes.filter_topk_roadgraph_points"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_topk_roadgraph_points</span></code></a>(→ RoadgraphPoints)</p></td>
<td><p>Returns the topk closest roadgraph points to a reference point.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#waymax.datatypes.is_road_edge" title="waymax.datatypes.is_road_edge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_road_edge</span></code></a>(→ jax.Array)</p></td>
<td><p>Determines which map elements in a tensor are road edges.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#waymax.datatypes.get_control_mask" title="waymax.datatypes.get_control_mask"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_control_mask</span></code></a>(→ jax.Array)</p></td>
<td><p>Returns binary mask for selected object type.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#waymax.datatypes.update_state_by_log" title="waymax.datatypes.update_state_by_log"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_state_by_log</span></code></a>(→ SimulatorState)</p></td>
<td><p>Advances SimulatorState by num_steps using logged data.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="attributes">
<h3>Attributes<a class="headerlink" href="#attributes" title="Permalink to this heading">#</a></h3>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#waymax.datatypes.PyTree" title="waymax.datatypes.PyTree"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PyTree</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#waymax.datatypes.TIME_INTERVAL" title="waymax.datatypes.TIME_INTERVAL"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TIME_INTERVAL</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#waymax.datatypes.TIMESTEP_MICROS_INTERVAL" title="waymax.datatypes.TIMESTEP_MICROS_INTERVAL"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TIMESTEP_MICROS_INTERVAL</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#waymax.datatypes.dynamic_update_slice_in_dim" title="waymax.datatypes.dynamic_update_slice_in_dim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dynamic_update_slice_in_dim</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="waymax.datatypes.Action">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">Action</span></span><a class="headerlink" href="#waymax.datatypes.Action" title="Permalink to this definition">#</a></dt>
<dd><p>Raw actions tensor and validity mask.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.Action.data">
<span class="sig-name descname"><span class="pre">data</span></span><a class="headerlink" href="#waymax.datatypes.Action.data" title="Permalink to this definition">#</a></dt>
<dd><p>Action array for all agents in the scene of shape (…, num_objects,
dim).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.Action.valid">
<span class="sig-name descname"><span class="pre">valid</span></span><a class="headerlink" href="#waymax.datatypes.Action.valid" title="Permalink to this definition">#</a></dt>
<dd><p>Whether or not an action is valid for a given agent of shape (…,
num_objects, 1).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.Action.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Ellipsis</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#waymax.datatypes.Action.shape" title="Permalink to this definition">#</a></dt>
<dd><p>The tensor shape of actions.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id0" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">valid</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id1" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.datatypes.Action.__eq__">
<span class="sig-name descname"><span class="pre">__eq__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#waymax.datatypes.Action.__eq__" title="Permalink to this definition">#</a></dt>
<dd><p>Return self==value.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.datatypes.Action.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#waymax.datatypes.Action.validate" title="Permalink to this definition">#</a></dt>
<dd><p>Validates shape and type.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="waymax.datatypes.TrajectoryUpdate">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">TrajectoryUpdate</span></span><a class="headerlink" href="#waymax.datatypes.TrajectoryUpdate" title="Permalink to this definition">#</a></dt>
<dd><p>A datastructure holding the controllable parts of a Trajectory.</p>
<p>The TrajectoryUpdate class contains the fields that a dynamics model is
allowed to update (pose and velocity). Remaining fields, such as object
dimensions and timestamps, are computed using common code
(see <cite>update_state_with_dynamics_trajectory</cite>).</p>
<p>As all dynamics produce a TrajectoryUpdate (via the <cite>compute_update</cite> method),
the TrajectoryUpdate serves as an intermediate update format that is common
to all dynamics models. This allows handling of multiple agents using
heterogeneous dynamics models.</p>
<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.TrajectoryUpdate.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Ellipsis</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#waymax.datatypes.TrajectoryUpdate.shape" title="Permalink to this definition">#</a></dt>
<dd><p>The tensor shape of actions.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.TrajectoryUpdate.x">
<span class="sig-name descname"><span class="pre">x</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#waymax.datatypes.TrajectoryUpdate.x" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.TrajectoryUpdate.y">
<span class="sig-name descname"><span class="pre">y</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#waymax.datatypes.TrajectoryUpdate.y" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.TrajectoryUpdate.yaw">
<span class="sig-name descname"><span class="pre">yaw</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#waymax.datatypes.TrajectoryUpdate.yaw" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.TrajectoryUpdate.vel_x">
<span class="sig-name descname"><span class="pre">vel_x</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#waymax.datatypes.TrajectoryUpdate.vel_x" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.TrajectoryUpdate.vel_y">
<span class="sig-name descname"><span class="pre">vel_y</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#waymax.datatypes.TrajectoryUpdate.vel_y" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.TrajectoryUpdate.valid">
<span class="sig-name descname"><span class="pre">valid</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#waymax.datatypes.TrajectoryUpdate.valid" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.datatypes.TrajectoryUpdate.__eq__">
<span class="sig-name descname"><span class="pre">__eq__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#waymax.datatypes.TrajectoryUpdate.__eq__" title="Permalink to this definition">#</a></dt>
<dd><p>Return self==value.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.datatypes.TrajectoryUpdate.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#waymax.datatypes.TrajectoryUpdate.validate" title="Permalink to this definition">#</a></dt>
<dd><p>Validates shape and type.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.datatypes.TrajectoryUpdate.as_action">
<span class="sig-name descname"><span class="pre">as_action</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#waymax.datatypes.Action" title="waymax.datatypes.Action"><span class="pre">Action</span></a></span></span><a class="headerlink" href="#waymax.datatypes.TrajectoryUpdate.as_action" title="Permalink to this definition">#</a></dt>
<dd><p>Returns this trajectory update as a 5D Action for StateDynamics.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>An action data structure with data of shape (…, 5) containing
x, y, yaw, vel_x, and vel_y.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="waymax.datatypes.MaskedArray">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">MaskedArray</span></span><a class="headerlink" href="#waymax.datatypes.MaskedArray" title="Permalink to this definition">#</a></dt>
<dd><p>A dataclass holding values and a validity mask.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.MaskedArray.value">
<span class="sig-name descname"><span class="pre">value</span></span><a class="headerlink" href="#waymax.datatypes.MaskedArray.value" title="Permalink to this definition">#</a></dt>
<dd><p>A valid.shape + (…) array of values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.MaskedArray.valid">
<span class="sig-name descname"><span class="pre">valid</span></span><a class="headerlink" href="#waymax.datatypes.MaskedArray.valid" title="Permalink to this definition">#</a></dt>
<dd><p>A boolean validity mask.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.MaskedArray.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Ellipsis</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#waymax.datatypes.MaskedArray.shape" title="Permalink to this definition">#</a></dt>
<dd><p>The Array prefix shape of the value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">value</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id2" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">valid</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id3" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.datatypes.MaskedArray.__eq__">
<span class="sig-name descname"><span class="pre">__eq__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#waymax.datatypes.MaskedArray.__eq__" title="Permalink to this definition">#</a></dt>
<dd><p>Return self==value.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.datatypes.MaskedArray.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#waymax.datatypes.MaskedArray.validate" title="Permalink to this definition">#</a></dt>
<dd><p>Validates shape and type.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.datatypes.MaskedArray.create_and_validate">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create_and_validate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#waymax.datatypes.MaskedArray" title="waymax.datatypes.MaskedArray"><span class="pre">MaskedArray</span></a></span></span><a class="headerlink" href="#waymax.datatypes.MaskedArray.create_and_validate" title="Permalink to this definition">#</a></dt>
<dd><p>Creates an instance of the class.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.datatypes.MaskedArray.masked_value">
<span class="sig-name descname"><span class="pre">masked_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">jax.Array</span></span></span><a class="headerlink" href="#waymax.datatypes.MaskedArray.masked_value" title="Permalink to this definition">#</a></dt>
<dd><p>Returns <cite>value</cite> where invalid elements are replaced with <cite>fill_value</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fill_value</strong> – Value with which to replace invalid elements. Must be castable
to the dtype of <cite>value</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>value</cite> where invalid elements are replaced with <cite>fill_value</cite>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="waymax.datatypes.PyTree">
<span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">PyTree</span></span><a class="headerlink" href="#waymax.datatypes.PyTree" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="waymax.datatypes.TIME_INTERVAL">
<span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">TIME_INTERVAL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.1</span></em><a class="headerlink" href="#waymax.datatypes.TIME_INTERVAL" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="waymax.datatypes.TIMESTEP_MICROS_INTERVAL">
<span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">TIMESTEP_MICROS_INTERVAL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">100000</span></em><a class="headerlink" href="#waymax.datatypes.TIMESTEP_MICROS_INTERVAL" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="waymax.datatypes.fill_invalid_trajectory">
<span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">fill_invalid_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#waymax.datatypes.Trajectory" title="waymax.datatypes.Trajectory"><span class="pre">Trajectory</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#waymax.datatypes.Trajectory" title="waymax.datatypes.Trajectory"><span class="pre">Trajectory</span></a></span></span><a class="headerlink" href="#waymax.datatypes.fill_invalid_trajectory" title="Permalink to this definition">#</a></dt>
<dd><p>Fills a trajectory with invalid values.</p>
<p>An invalid value is -1 for numerical fields and False for booleans.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>traj</strong> – Trajectory to fill.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new trajectory with invalid values.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="waymax.datatypes.ObjectMetadata">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">ObjectMetadata</span></span><a class="headerlink" href="#waymax.datatypes.ObjectMetadata" title="Permalink to this definition">#</a></dt>
<dd><p>Time-independent object metadata.</p>
<p>All arrays are of shape (…, num_objects).</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.ObjectMetadata.ids">
<span class="sig-name descname"><span class="pre">ids</span></span><a class="headerlink" href="#waymax.datatypes.ObjectMetadata.ids" title="Permalink to this definition">#</a></dt>
<dd><p>A unique integer id for each object which is consistent over time of
data type int32.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.ObjectMetadata.object_types">
<span class="sig-name descname"><span class="pre">object_types</span></span><a class="headerlink" href="#waymax.datatypes.ObjectMetadata.object_types" title="Permalink to this definition">#</a></dt>
<dd><p>An integer representing each different class of object
(Unset=0, Vehicle=1, Pedestrian=2, Cyclist=3, Other=4) of data type int32.
This definition is from Waymo Open Motion Dataset (WOMD).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.ObjectMetadata.is_sdc">
<span class="sig-name descname"><span class="pre">is_sdc</span></span><a class="headerlink" href="#waymax.datatypes.ObjectMetadata.is_sdc" title="Permalink to this definition">#</a></dt>
<dd><p>Binary mask of data type bool representing whether an object
represents the sdc or some other object.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.ObjectMetadata.is_modeled">
<span class="sig-name descname"><span class="pre">is_modeled</span></span><a class="headerlink" href="#waymax.datatypes.ObjectMetadata.is_modeled" title="Permalink to this definition">#</a></dt>
<dd><p>Whether a specific object is one designated by WOMD to be
predicted of data type bool.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.ObjectMetadata.is_valid">
<span class="sig-name descname"><span class="pre">is_valid</span></span><a class="headerlink" href="#waymax.datatypes.ObjectMetadata.is_valid" title="Permalink to this definition">#</a></dt>
<dd><p>Whether an object is valid at any part of the run segment of data
type bool.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.ObjectMetadata.objects_of_interest">
<span class="sig-name descname"><span class="pre">objects_of_interest</span></span><a class="headerlink" href="#waymax.datatypes.ObjectMetadata.objects_of_interest" title="Permalink to this definition">#</a></dt>
<dd><p>A vector of type bool to indicate which objects in the
scene corresponding to the first dimension of the object tensors have
interactive behavior. Up to 2 objects will be selected. The objects in
this list form an interactive group.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.ObjectMetadata.is_controlled">
<span class="sig-name descname"><span class="pre">is_controlled</span></span><a class="headerlink" href="#waymax.datatypes.ObjectMetadata.is_controlled" title="Permalink to this definition">#</a></dt>
<dd><p>Whether an object will be controlled by external agents in an
environment.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.ObjectMetadata.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Ellipsis</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#waymax.datatypes.ObjectMetadata.shape" title="Permalink to this definition">#</a></dt>
<dd><p>The Array shape of the metadata.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.ObjectMetadata.num_objects">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_objects</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#waymax.datatypes.ObjectMetadata.num_objects" title="Permalink to this definition">#</a></dt>
<dd><p>The number of objects in metadata.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">ids</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id4" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id5">
<span class="sig-name descname"><span class="pre">object_types</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id5" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id6">
<span class="sig-name descname"><span class="pre">is_sdc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id6" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id7">
<span class="sig-name descname"><span class="pre">is_modeled</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id7" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id8">
<span class="sig-name descname"><span class="pre">is_valid</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id8" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id9">
<span class="sig-name descname"><span class="pre">objects_of_interest</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id9" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id10">
<span class="sig-name descname"><span class="pre">is_controlled</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id10" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.datatypes.ObjectMetadata.__eq__">
<span class="sig-name descname"><span class="pre">__eq__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#waymax.datatypes.ObjectMetadata.__eq__" title="Permalink to this definition">#</a></dt>
<dd><p>Return self==value.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.datatypes.ObjectMetadata.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#waymax.datatypes.ObjectMetadata.validate" title="Permalink to this definition">#</a></dt>
<dd><p>Validates shape and type.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="waymax.datatypes.ObjectTypeIds">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">ObjectTypeIds</span></span><a class="headerlink" href="#waymax.datatypes.ObjectTypeIds" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">enum.IntEnum</span></code></p>
<p>Ids for different map elements to be mapped into a tensor.</p>
<dl class="simple">
<dt>These integers represent the ID of these specific types as defined in:</dt><dd><p><a class="reference external" href="https://waymo.com/open/data/motion/tfexample">https://waymo.com/open/data/motion/tfexample</a>.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.ObjectTypeIds.UNSET">
<span class="sig-name descname"><span class="pre">UNSET</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#waymax.datatypes.ObjectTypeIds.UNSET" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.ObjectTypeIds.VEHICLE">
<span class="sig-name descname"><span class="pre">VEHICLE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#waymax.datatypes.ObjectTypeIds.VEHICLE" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.ObjectTypeIds.PEDESTRIAN">
<span class="sig-name descname"><span class="pre">PEDESTRIAN</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#waymax.datatypes.ObjectTypeIds.PEDESTRIAN" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.ObjectTypeIds.CYCLIST">
<span class="sig-name descname"><span class="pre">CYCLIST</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#waymax.datatypes.ObjectTypeIds.CYCLIST" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.ObjectTypeIds.OTHER">
<span class="sig-name descname"><span class="pre">OTHER</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4</span></em><a class="headerlink" href="#waymax.datatypes.ObjectTypeIds.OTHER" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="waymax.datatypes.Trajectory">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">Trajectory</span></span><a class="headerlink" href="#waymax.datatypes.Trajectory" title="Permalink to this definition">#</a></dt>
<dd><p>Data structure representing a trajectory.</p>
<p>The shapes of all objects are of shape (…, num_objects, num_timesteps).</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.Trajectory.x">
<span class="sig-name descname"><span class="pre">x</span></span><a class="headerlink" href="#waymax.datatypes.Trajectory.x" title="Permalink to this definition">#</a></dt>
<dd><p>The x coordinate of each object at each time step of data type float32.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.Trajectory.y">
<span class="sig-name descname"><span class="pre">y</span></span><a class="headerlink" href="#waymax.datatypes.Trajectory.y" title="Permalink to this definition">#</a></dt>
<dd><p>The y coordinate of each object at each time step of data type float32.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.Trajectory.z">
<span class="sig-name descname"><span class="pre">z</span></span><a class="headerlink" href="#waymax.datatypes.Trajectory.z" title="Permalink to this definition">#</a></dt>
<dd><p>The z coordinate of each object at each time step of data type float32.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.Trajectory.vel_x">
<span class="sig-name descname"><span class="pre">vel_x</span></span><a class="headerlink" href="#waymax.datatypes.Trajectory.vel_x" title="Permalink to this definition">#</a></dt>
<dd><p>The x component of the object velocity at each time step of data type
float32.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.Trajectory.vel_y">
<span class="sig-name descname"><span class="pre">vel_y</span></span><a class="headerlink" href="#waymax.datatypes.Trajectory.vel_y" title="Permalink to this definition">#</a></dt>
<dd><p>The y component of the object velocity at each time step of data type
float32.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.Trajectory.yaw">
<span class="sig-name descname"><span class="pre">yaw</span></span><a class="headerlink" href="#waymax.datatypes.Trajectory.yaw" title="Permalink to this definition">#</a></dt>
<dd><p>Counter-clockwise yaw in top-down view (rotation about the Z axis from
a unit X vector to the object direction vector) of shape of data type
float32.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.Trajectory.valid">
<span class="sig-name descname"><span class="pre">valid</span></span><a class="headerlink" href="#waymax.datatypes.Trajectory.valid" title="Permalink to this definition">#</a></dt>
<dd><p>Validity bit for all object at all times steps of data type bool.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.Trajectory.timestamp_micros">
<span class="sig-name descname"><span class="pre">timestamp_micros</span></span><a class="headerlink" href="#waymax.datatypes.Trajectory.timestamp_micros" title="Permalink to this definition">#</a></dt>
<dd><p>A timestamp in microseconds for each time step of data
type int32.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.Trajectory.length">
<span class="sig-name descname"><span class="pre">length</span></span><a class="headerlink" href="#waymax.datatypes.Trajectory.length" title="Permalink to this definition">#</a></dt>
<dd><p>The length of each object at each time step of data type float32.
Note for each object, its length is fixed for all time steps.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.Trajectory.width">
<span class="sig-name descname"><span class="pre">width</span></span><a class="headerlink" href="#waymax.datatypes.Trajectory.width" title="Permalink to this definition">#</a></dt>
<dd><p>The width of each object at each time step of data type float32. Note
for each object, its width is fixed for all time steps.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.Trajectory.height">
<span class="sig-name descname"><span class="pre">height</span></span><a class="headerlink" href="#waymax.datatypes.Trajectory.height" title="Permalink to this definition">#</a></dt>
<dd><p>The height of each object at each time step of data type float32.
Note for each object, its height is fixed for all time steps.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.Trajectory.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Ellipsis</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#waymax.datatypes.Trajectory.shape" title="Permalink to this definition">#</a></dt>
<dd><p>The Array shape of this trajectory.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.Trajectory.num_objects">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_objects</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#waymax.datatypes.Trajectory.num_objects" title="Permalink to this definition">#</a></dt>
<dd><p>The number of objects included in this trajectory per example.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.Trajectory.num_timesteps">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_timesteps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#waymax.datatypes.Trajectory.num_timesteps" title="Permalink to this definition">#</a></dt>
<dd><p>The length of this trajectory in time.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.Trajectory.xy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#waymax.datatypes.Trajectory.xy" title="Permalink to this definition">#</a></dt>
<dd><p>Stacked xy location.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.Trajectory.xyz">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xyz</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#waymax.datatypes.Trajectory.xyz" title="Permalink to this definition">#</a></dt>
<dd><p>Stacked xyz location.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.Trajectory.vel_xy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">vel_xy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#waymax.datatypes.Trajectory.vel_xy" title="Permalink to this definition">#</a></dt>
<dd><p>Stacked xy velocity.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.Trajectory.speed">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">speed</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#waymax.datatypes.Trajectory.speed" title="Permalink to this definition">#</a></dt>
<dd><p>Speed on x-y plane.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.Trajectory.vel_yaw">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">vel_yaw</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#waymax.datatypes.Trajectory.vel_yaw" title="Permalink to this definition">#</a></dt>
<dd><p>Angle of the velocity on x-y plane.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.Trajectory.bbox_corners">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bbox_corners</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#waymax.datatypes.Trajectory.bbox_corners" title="Permalink to this definition">#</a></dt>
<dd><p>Corners of the bounding box spanning the object’s shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Box corners’ (x, y) coordinates spanning the object of shape</dt><dd><p>(…, num_objects, num_timesteps, 4, 2). The 4 corners start from the
objects’ front right corner and go counter-clockwise.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id11">
<span class="sig-name descname"><span class="pre">x</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id11" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id12">
<span class="sig-name descname"><span class="pre">y</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id12" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id13">
<span class="sig-name descname"><span class="pre">z</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id13" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id14">
<span class="sig-name descname"><span class="pre">vel_x</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id14" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id15">
<span class="sig-name descname"><span class="pre">vel_y</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id15" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id16">
<span class="sig-name descname"><span class="pre">yaw</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id16" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id17">
<span class="sig-name descname"><span class="pre">valid</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id17" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id18">
<span class="sig-name descname"><span class="pre">timestamp_micros</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id18" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id19">
<span class="sig-name descname"><span class="pre">length</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id19" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id20">
<span class="sig-name descname"><span class="pre">width</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id20" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id21">
<span class="sig-name descname"><span class="pre">height</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id21" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.datatypes.Trajectory.__eq__">
<span class="sig-name descname"><span class="pre">__eq__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#waymax.datatypes.Trajectory.__eq__" title="Permalink to this definition">#</a></dt>
<dd><p>Return self==value.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.datatypes.Trajectory.stack_fields">
<span class="sig-name descname"><span class="pre">stack_fields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">collections.abc.Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">jax.Array</span></span></span><a class="headerlink" href="#waymax.datatypes.Trajectory.stack_fields" title="Permalink to this definition">#</a></dt>
<dd><p>Returns a concatenated version of a set of field names for Trajectory.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.datatypes.Trajectory.zeros">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">zeros</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">collections.abc.Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#waymax.datatypes.Trajectory" title="waymax.datatypes.Trajectory"><span class="pre">Trajectory</span></a></span></span><a class="headerlink" href="#waymax.datatypes.Trajectory.zeros" title="Permalink to this definition">#</a></dt>
<dd><p>Creates a Trajectory containing zeros of the specified shape.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.datatypes.Trajectory.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#waymax.datatypes.Trajectory.validate" title="Permalink to this definition">#</a></dt>
<dd><p>Validates shape and type.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="waymax.datatypes.ObjectPose2D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">ObjectPose2D</span></span><a class="headerlink" href="#waymax.datatypes.ObjectPose2D" title="Permalink to this definition">#</a></dt>
<dd><p>Object 2D pose that can be used for coordinate transformation.</p>
<p>The pose information is stored with two format
(see details at <a class="reference external" href="https://en.wikipedia.org/wiki/Pose_(computer_vision">https://en.wikipedia.org/wiki/Pose_(computer_vision</a>)):
1) the position (original_xy) and orientation (original_yaw); 2) the
transformation matrix (matrix) with the rotation angle explicitly saved as
delta_yaw.</p>
<p>Note since this is a general data structure, the pose could be using arbitrary
coordinate system.</p>
<p>Example usage:
Assuming the pose is using C coordinate system, applying matrix[…, i, :, :]
over an object with center (x, y) and yaw in C coordinate system gives its
position in i’s local coordinate system. The object’s yaw in i’s local
coordinate system is yaw + delta_yaw.
This is done by translation of -original_xy followed by counter-clockwise
rotation of original_yaw.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.ObjectPose2D.original_xy">
<span class="sig-name descname"><span class="pre">original_xy</span></span><a class="headerlink" href="#waymax.datatypes.ObjectPose2D.original_xy" title="Permalink to this definition">#</a></dt>
<dd><p>(…, num_objects, 2), the coordinates of each object’s center
in original coordinate systems.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.ObjectPose2D.original_yaw">
<span class="sig-name descname"><span class="pre">original_yaw</span></span><a class="headerlink" href="#waymax.datatypes.ObjectPose2D.original_yaw" title="Permalink to this definition">#</a></dt>
<dd><p>(…, num_objects), object’s yaw in original coordinate
systems.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.ObjectPose2D.matrix">
<span class="sig-name descname"><span class="pre">matrix</span></span><a class="headerlink" href="#waymax.datatypes.ObjectPose2D.matrix" title="Permalink to this definition">#</a></dt>
<dd><p>(…, num_objects, 3, 3), transformation matrix where <cite>matrix[…,
i, :, :]</cite> is the transformation from original coordinates to object <cite>i</cite>
centric coordinates.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.ObjectPose2D.delta_yaw">
<span class="sig-name descname"><span class="pre">delta_yaw</span></span><a class="headerlink" href="#waymax.datatypes.ObjectPose2D.delta_yaw" title="Permalink to this definition">#</a></dt>
<dd><p>(…, num_objects), rotation angles used to transform yaw in
original coordinate system to object-center coordinate system. Note this
is the negative of original_yaw.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.ObjectPose2D.valid">
<span class="sig-name descname"><span class="pre">valid</span></span><a class="headerlink" href="#waymax.datatypes.ObjectPose2D.valid" title="Permalink to this definition">#</a></dt>
<dd><p>(…, num_objects), valid or not.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.ObjectPose2D.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Ellipsis</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#waymax.datatypes.ObjectPose2D.shape" title="Permalink to this definition">#</a></dt>
<dd><p>The Array shape.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.ObjectPose2D.num_objects">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_objects</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#waymax.datatypes.ObjectPose2D.num_objects" title="Permalink to this definition">#</a></dt>
<dd><p>The number of objects.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.ObjectPose2D.rotation_matrix">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rotation_matrix</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#waymax.datatypes.ObjectPose2D.rotation_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>2D rotation matrix.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.ObjectPose2D.translation_vector">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">translation_vector</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#waymax.datatypes.ObjectPose2D.translation_vector" title="Permalink to this definition">#</a></dt>
<dd><p>2D translation vector.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id22">
<span class="sig-name descname"><span class="pre">original_xy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id22" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id23">
<span class="sig-name descname"><span class="pre">original_yaw</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id23" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id24">
<span class="sig-name descname"><span class="pre">matrix</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id24" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id25">
<span class="sig-name descname"><span class="pre">delta_yaw</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id25" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id26">
<span class="sig-name descname"><span class="pre">valid</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id26" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.datatypes.ObjectPose2D.__eq__">
<span class="sig-name descname"><span class="pre">__eq__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#waymax.datatypes.ObjectPose2D.__eq__" title="Permalink to this definition">#</a></dt>
<dd><p>Return self==value.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.datatypes.ObjectPose2D.from_center_and_yaw">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_center_and_yaw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yaw</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#waymax.datatypes.ObjectPose2D" title="waymax.datatypes.ObjectPose2D"><span class="pre">ObjectPose2D</span></a></span></span><a class="headerlink" href="#waymax.datatypes.ObjectPose2D.from_center_and_yaw" title="Permalink to this definition">#</a></dt>
<dd><p>Initializes pose from center location and yaw.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xy</strong> – (…, num_objects, 2), 2D coordinates of objects’ center in arbitrary
coordinate system.</p></li>
<li><p><strong>yaw</strong> – (…, num_objects), objects’ yaw in same coordinate system as xy.</p></li>
<li><p><strong>valid</strong> – (…, num_objects), boolean mask for validity.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A ObjectPose2D with shape (…, num_objects).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.datatypes.ObjectPose2D.from_transformation">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_transformation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_yaw</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#waymax.datatypes.ObjectPose2D" title="waymax.datatypes.ObjectPose2D"><span class="pre">ObjectPose2D</span></a></span></span><a class="headerlink" href="#waymax.datatypes.ObjectPose2D.from_transformation" title="Permalink to this definition">#</a></dt>
<dd><p>Init pose from transformation matrix and delta_yaw.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>matrix</strong> – (…, num_objects, 3, 3), 2D homogenous transformation matrix.</p></li>
<li><p><strong>delta_yaw</strong> – (…, num_objects), transformation angles used together with
matrix for coordinate transformation (i.e. rotation applied by the
transformation matrix).</p></li>
<li><p><strong>valid</strong> – (…, num_objects), boolean mask for validity.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A ObjectPose2D with shape (…, num_objects).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.datatypes.ObjectPose2D.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#waymax.datatypes.ObjectPose2D.validate" title="Permalink to this definition">#</a></dt>
<dd><p>Validates shape and type.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="waymax.datatypes.Observation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">Observation</span></span><a class="headerlink" href="#waymax.datatypes.Observation" title="Permalink to this definition">#</a></dt>
<dd><p>Observation at a single simulation step.</p>
<p>num_observations: number of objects that will have an observation/view over
other objects/map elements.</p>
<p>The observation can include a fixed number of history information. Note we
support multi-agent observation by default: for each object (in axis
num_observations), we compute its view of all other objects (in axis
num_objects), roadgraph points, and traffic lights. The coordinates used for
each object (num_observations) are centered at its location defined by pose2d.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.Observation.trajectory">
<span class="sig-name descname"><span class="pre">trajectory</span></span><a class="headerlink" href="#waymax.datatypes.Observation.trajectory" title="Permalink to this definition">#</a></dt>
<dd><p>Time-dependent information, in object-centric coordinates
defined by pose2d of shape (…, num_observations, num_objects,
num_timesteps).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.Observation.is_ego">
<span class="sig-name descname"><span class="pre">is_ego</span></span><a class="headerlink" href="#waymax.datatypes.Observation.is_ego" title="Permalink to this definition">#</a></dt>
<dd><p>Binary mask of shape (…, num_observations, num_objects). It
represents which object in num_objects is the observer itself.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.Observation.pose2d">
<span class="sig-name descname"><span class="pre">pose2d</span></span><a class="headerlink" href="#waymax.datatypes.Observation.pose2d" title="Permalink to this definition">#</a></dt>
<dd><p>Poses for all objects, used for transformation of shape (…,
num_observations).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.Observation.metadata">
<span class="sig-name descname"><span class="pre">metadata</span></span><a class="headerlink" href="#waymax.datatypes.Observation.metadata" title="Permalink to this definition">#</a></dt>
<dd><p>Time-independent information of shape (…, num_observations,
num_objects).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.Observation.roadgraph_static_points">
<span class="sig-name descname"><span class="pre">roadgraph_static_points</span></span><a class="headerlink" href="#waymax.datatypes.Observation.roadgraph_static_points" title="Permalink to this definition">#</a></dt>
<dd><p>Top-k (k=num_points) nearest static roadgraph
points of shape (…, num_observations, num_points).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.Observation.traffic_lights">
<span class="sig-name descname"><span class="pre">traffic_lights</span></span><a class="headerlink" href="#waymax.datatypes.Observation.traffic_lights" title="Permalink to this definition">#</a></dt>
<dd><p>Current state of the traffic lights in the log of shape
(…, num_observations, num_traffic_lights, num_timesteps).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.Observation.sdc_paths">
<span class="sig-name descname"><span class="pre">sdc_paths</span></span><a class="headerlink" href="#waymax.datatypes.Observation.sdc_paths" title="Permalink to this definition">#</a></dt>
<dd><p>SDC roadgraph traversal paths. Only valid for SDC agents of shape
(…, num_observations, num_paths, num_points_per_path).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.Observation.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Ellipsis</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#waymax.datatypes.Observation.shape" title="Permalink to this definition">#</a></dt>
<dd><p>(…, num_observations).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>The longest common prefix shape of all attributes</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.Observation.batch_dims">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">batch_dims</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Ellipsis</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#waymax.datatypes.Observation.batch_dims" title="Permalink to this definition">#</a></dt>
<dd><p>Batch dimensions.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.Observation.num_objects">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_objects</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#waymax.datatypes.Observation.num_objects" title="Permalink to this definition">#</a></dt>
<dd><p>The number of objects.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.Observation.valid">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">valid</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#waymax.datatypes.Observation.valid" title="Permalink to this definition">#</a></dt>
<dd><p>Whether the observation is valid, (…, num_observations).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id27">
<span class="sig-name descname"><span class="pre">trajectory</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="object_state/index.html#waymax.datatypes.object_state.Trajectory" title="waymax.datatypes.object_state.Trajectory"><span class="pre">waymax.datatypes.object_state.Trajectory</span></a></em><a class="headerlink" href="#id27" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id28">
<span class="sig-name descname"><span class="pre">is_ego</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id28" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id29">
<span class="sig-name descname"><span class="pre">pose2d</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#waymax.datatypes.ObjectPose2D" title="waymax.datatypes.ObjectPose2D"><span class="pre">ObjectPose2D</span></a></em><a class="headerlink" href="#id29" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id30">
<span class="sig-name descname"><span class="pre">metadata</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="object_state/index.html#waymax.datatypes.object_state.ObjectMetadata" title="waymax.datatypes.object_state.ObjectMetadata"><span class="pre">waymax.datatypes.object_state.ObjectMetadata</span></a></em><a class="headerlink" href="#id30" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id31">
<span class="sig-name descname"><span class="pre">roadgraph_static_points</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="roadgraph/index.html#waymax.datatypes.roadgraph.RoadgraphPoints" title="waymax.datatypes.roadgraph.RoadgraphPoints"><span class="pre">waymax.datatypes.roadgraph.RoadgraphPoints</span></a></em><a class="headerlink" href="#id31" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id32">
<span class="sig-name descname"><span class="pre">traffic_lights</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Observation.traffic_lights</span></em><a class="headerlink" href="#id32" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id33">
<span class="sig-name descname"><span class="pre">sdc_paths</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="route/index.html#waymax.datatypes.route.Paths" title="waymax.datatypes.route.Paths"><span class="pre">waymax.datatypes.route.Paths</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id33" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.datatypes.Observation.for_obj">
<span class="sig-name descname"><span class="pre">for_obj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#waymax.datatypes.Observation" title="waymax.datatypes.Observation"><span class="pre">Observation</span></a></span></span><a class="headerlink" href="#waymax.datatypes.Observation.for_obj" title="Permalink to this definition">#</a></dt>
<dd><p>Observation from idx-th object’s point of view over all objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>idx</strong> – The index of the object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A Observation with shape (…, 1).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.datatypes.Observation.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#waymax.datatypes.Observation.validate" title="Permalink to this definition">#</a></dt>
<dd><p>Validates shape and type.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="waymax.datatypes.observation_from_state">
<span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">observation_from_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="simulator_state/index.html#waymax.datatypes.simulator_state.SimulatorState" title="waymax.datatypes.simulator_state.SimulatorState"><span class="pre">waymax.datatypes.simulator_state.SimulatorState</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_num_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">roadgraph_top_k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_frame</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../config/index.html#waymax.config.CoordinateFrame" title="waymax.config.CoordinateFrame"><span class="pre">waymax.config.CoordinateFrame</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">config.CoordinateFrame.GLOBAL</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#waymax.datatypes.Observation" title="waymax.datatypes.Observation"><span class="pre">Observation</span></a></span></span><a class="headerlink" href="#waymax.datatypes.observation_from_state" title="Permalink to this definition">#</a></dt>
<dd><p>Constructs Observation from SimulatorState for all agents (jit-able).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – A SimulatorState, with entirely variable shape (…).</p></li>
<li><p><strong>obs_num_steps</strong> – Number of steps history included in observation. Last
timestep is state.timestep.</p></li>
<li><p><strong>roadgraph_top_k</strong> – Number of topk roadgraph observed by each object.</p></li>
<li><p><strong>coordinate_frame</strong> – Which coordinate frame the returned observation is using.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Observation at current timestep from given simulator state, with shape (…,
num_objects).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="waymax.datatypes.sdc_observation_from_state">
<span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">sdc_observation_from_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="simulator_state/index.html#waymax.datatypes.simulator_state.SimulatorState" title="waymax.datatypes.simulator_state.SimulatorState"><span class="pre">waymax.datatypes.simulator_state.SimulatorState</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_num_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">roadgraph_top_k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinate_frame</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../config/index.html#waymax.config.CoordinateFrame" title="waymax.config.CoordinateFrame"><span class="pre">waymax.config.CoordinateFrame</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">config.CoordinateFrame.SDC</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#waymax.datatypes.Observation" title="waymax.datatypes.Observation"><span class="pre">Observation</span></a></span></span><a class="headerlink" href="#waymax.datatypes.sdc_observation_from_state" title="Permalink to this definition">#</a></dt>
<dd><p>Constructs Observation from SimulatorState for SDC only (jit-able).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> – a SimulatorState, with shape (…)</p></li>
<li><p><strong>obs_num_steps</strong> – number of steps history included in observation. Last
timestep is state.timestep.</p></li>
<li><p><strong>roadgraph_top_k</strong> – number of topk roadgraph observed by each object.</p></li>
<li><p><strong>coordinate_frame</strong> – which coordinate frame the returned observation is using.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>SDC Observation at current timestep from given simulator state, with shape
(…, 1), where the last object dimension is 1 as there is only one SDC. It
is not sequeezed to be consistent with multi-agent cases and compatible for
other utils fnctions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="waymax.datatypes.transform_observation">
<span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">transform_observation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#waymax.datatypes.Observation" title="waymax.datatypes.Observation"><span class="pre">Observation</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">pose2d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#waymax.datatypes.ObjectPose2D" title="waymax.datatypes.ObjectPose2D"><span class="pre">ObjectPose2D</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#waymax.datatypes.Observation" title="waymax.datatypes.Observation"><span class="pre">Observation</span></a></span></span><a class="headerlink" href="#waymax.datatypes.transform_observation" title="Permalink to this definition">#</a></dt>
<dd><p>Transforms a Observation into coordinates specified by pose2d.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>observation</strong> – Has shape (…, num_observations)</p></li>
<li><p><strong>pose2d</strong> – Has shape (…, num_observations)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Transformed observation in local coordinates per-observation defined by the
pose.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="waymax.datatypes.transform_roadgraph_points">
<span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">transform_roadgraph_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">roadgraph_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="roadgraph/index.html#waymax.datatypes.roadgraph.RoadgraphPoints" title="waymax.datatypes.roadgraph.RoadgraphPoints"><span class="pre">waymax.datatypes.roadgraph.RoadgraphPoints</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">pose2d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#waymax.datatypes.ObjectPose2D" title="waymax.datatypes.ObjectPose2D"><span class="pre">ObjectPose2D</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="roadgraph/index.html#waymax.datatypes.roadgraph.RoadgraphPoints" title="waymax.datatypes.roadgraph.RoadgraphPoints"><span class="pre">waymax.datatypes.roadgraph.RoadgraphPoints</span></a></span></span><a class="headerlink" href="#waymax.datatypes.transform_roadgraph_points" title="Permalink to this definition">#</a></dt>
<dd><p>Transform a RoadgraphPoints into coordinates specified by pose2d.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>roadgraph_points</strong> – A RoadgraphPoints with shape (…, num_observations,
num_points).</p></li>
<li><p><strong>pose2d</strong> – A ObjectPose2D with shape (…, num_observations).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A transformed RoadgraphPoints in local coordinates per-observation defined
by the pose.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="waymax.datatypes.transform_traffic_lights">
<span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">transform_traffic_lights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tls</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="traffic_lights/index.html#waymax.datatypes.traffic_lights.TrafficLights" title="waymax.datatypes.traffic_lights.TrafficLights"><span class="pre">waymax.datatypes.traffic_lights.TrafficLights</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">pose2d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#waymax.datatypes.ObjectPose2D" title="waymax.datatypes.ObjectPose2D"><span class="pre">ObjectPose2D</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="traffic_lights/index.html#waymax.datatypes.traffic_lights.TrafficLights" title="waymax.datatypes.traffic_lights.TrafficLights"><span class="pre">waymax.datatypes.traffic_lights.TrafficLights</span></a></span></span><a class="headerlink" href="#waymax.datatypes.transform_traffic_lights" title="Permalink to this definition">#</a></dt>
<dd><p>Transforms a TrafficLightStates into coordinates specified by pose2d.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tls</strong> – A TrafficLightStates with shape (…, num_observations,
num_traffic_lights, num_timesteps).</p></li>
<li><p><strong>pose2d</strong> – A ObjectPose2D with shape (…, num_observations).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Transformed TrafficLightStates in local coordinates per-observation defined
by the pose.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="waymax.datatypes.transform_trajectory">
<span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">transform_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="object_state/index.html#waymax.datatypes.object_state.Trajectory" title="waymax.datatypes.object_state.Trajectory"><span class="pre">waymax.datatypes.object_state.Trajectory</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">pose2d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#waymax.datatypes.ObjectPose2D" title="waymax.datatypes.ObjectPose2D"><span class="pre">ObjectPose2D</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="object_state/index.html#waymax.datatypes.object_state.Trajectory" title="waymax.datatypes.object_state.Trajectory"><span class="pre">waymax.datatypes.object_state.Trajectory</span></a></span></span><a class="headerlink" href="#waymax.datatypes.transform_trajectory" title="Permalink to this definition">#</a></dt>
<dd><p>Transforms a Trajectory into coordinates specified by pose2d.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>traj</strong> – A Trajectory with shape (…, num_observations, num_objects,
num_timesteps) in coordinate system same as the one used by
original_xy/yaw in pose2d.</p></li>
<li><p><strong>pose2d</strong> – A ObjectPose2D with shape (…, num_observations).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A transformed trajectory in local coordinates per-observation defined by the
pose.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="waymax.datatypes.compare_all_leaf_nodes">
<span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">compare_all_leaf_nodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">first</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PyTree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PyTree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compare_func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">jax.Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax.Array</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">jnp.array_equal</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#waymax.datatypes.compare_all_leaf_nodes" title="Permalink to this definition">#</a></dt>
<dd><p>Checks if all leaf nodes are consistent via compare_func.</p>
<p>The default behaviour (with compare_func as jnp.array_equal) is to
compare if two PyTree are equal (i.e. all leaf nodes of array are equal).
One can also use compare_func as jnp.allclose to give some tolerance
for numerical difference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>first</strong> – A PyTree for comparison.</p></li>
<li><p><strong>second</strong> – A PyTree for comparison.</p></li>
<li><p><strong>compare_func</strong> – A function comparing nodes between two input arrays.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if inputs PyTrees are consistent by func.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="waymax.datatypes.dynamic_index">
<span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">dynamic_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PyTree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">PyTree</span></span></span><a class="headerlink" href="#waymax.datatypes.dynamic_index" title="Permalink to this definition">#</a></dt>
<dd><p>Wraps dynamic_index_in_dim on a PyTree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> – Object where each element in it is to be indexed.</p></li>
<li><p><strong>index</strong> – Element number to index into each array in the tree.</p></li>
<li><p><strong>axis</strong> – Axis of each array to perform the indexing in.</p></li>
<li><p><strong>keepdims</strong> – Whether or not to keep the same rank as <cite>inputs</cite>. If this is set
to <cite>True</cite> then the return value will be such that <cite>.shape[axis]</cite> == 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Array tree where every element of the tree has been indexed at the same</dt><dd><p>specified axis.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="waymax.datatypes.dynamic_slice">
<span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">dynamic_slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PyTree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">PyTree</span></span></span><a class="headerlink" href="#waymax.datatypes.dynamic_slice" title="Permalink to this definition">#</a></dt>
<dd><p>Wraps dynamic_slice_in_dim on a PyTree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> – Object where each element in its tree is to be sliced.</p></li>
<li><p><strong>start_index</strong> – Start index of slicing function.</p></li>
<li><p><strong>slice_size</strong> – Size of slice applied to <cite>inputs</cite> starting from <cite>start_index</cite> to
<cite>start_index</cite> + <cite>slice_size</cite>.</p></li>
<li><p><strong>axis</strong> – Axis of each array to perform the slicing in.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Array tree which has been sliced along an axis which maintains the same</dt><dd><p>rank as <cite>inputs</cite>.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="waymax.datatypes.dynamic_update_slice_in_dim">
<span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">dynamic_update_slice_in_dim</span></span><a class="headerlink" href="#waymax.datatypes.dynamic_update_slice_in_dim" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="waymax.datatypes.make_invalid_data">
<span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">make_invalid_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">jax.Array</span></span></span><a class="headerlink" href="#waymax.datatypes.make_invalid_data" title="Permalink to this definition">#</a></dt>
<dd><p>Returns a tensor of invalid values with identical shape to data.</p>
<p>Invalid values are defined as False for booleans, and -1 for numerical values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> – Tensor to invalidate.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor of invalid values of the same shape and dtype as data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="waymax.datatypes.masked_mean">
<span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">masked_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Axis</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invalid_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">jax.Array</span></span></span><a class="headerlink" href="#waymax.datatypes.masked_mean" title="Permalink to this definition">#</a></dt>
<dd><p>Calculates the mean of the array removing invalid values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – Input to the masked mean function.</p></li>
<li><p><strong>valid</strong> – Boolean array with the same shape as x which indicates which values
should be included in the mean.</p></li>
<li><p><strong>axis</strong> – Axis to reduce along.</p></li>
<li><p><strong>invalid_value</strong> – If there is no valid fields, the value will be replaced by
this invalid value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array representing the mean of the array of all valid values.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="waymax.datatypes.select_by_onehot">
<span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">select_by_onehot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PyTree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">PyTree</span></span></span><a class="headerlink" href="#waymax.datatypes.select_by_onehot" title="Permalink to this definition">#</a></dt>
<dd><p>Selects data using a one-hot vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – A pytree with leaf shapes (…, N, …).</p></li>
<li><p><strong>selection</strong> – A one-hot vector with shape (…, N).</p></li>
<li><p><strong>keepdims</strong> – Whether to leave a (1,) dimension on the selected axis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A pytree with leaf shapes (…, 1) if keepdims=True.
A pytree with leaf shapes (…, ) if keepdims=False.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="waymax.datatypes.update_by_mask">
<span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">update_by_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PyTree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">updates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PyTree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">PyTree</span></span></span><a class="headerlink" href="#waymax.datatypes.update_by_mask" title="Permalink to this definition">#</a></dt>
<dd><p>Updates inputs by updates (with same struct) for masked values.</p>
<dl class="simple">
<dt>Uses <cite>jax.tree_util</cite> to update each field as such:</dt><dd><p>inputs.field = jnp.where(mask, updates.field, inputs.field)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> – Represents the data to be updated and returned.</p></li>
<li><p><strong>updates</strong> – Represents the data that is passed in to update all fields. It is
assumed that the <cite>updates</cite> and the <cite>inputs</cite> have the same structure. These
fields must be broadcastable to the same shape as <cite>inputs</cite> after applying
the mask.</p></li>
<li><p><strong>mask</strong> – Mask that represents which elements of the <cite>inputs</cite> array tree to
update with the <cite>updates</cite> field. Shape must be broadcastable to the leaf
nodes of inputs and updates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Updated tree array of the same structure as <cite>inputs</cite> which has had all its</dt><dd><p>fields updated with the corresponding fields in <cite>updates</cite> conditioned on
whether <cite>mask</cite> requests it.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="waymax.datatypes.update_by_slice_in_dim">
<span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">update_by_slice_in_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PyTree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">updates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PyTree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs_start_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">updates_start_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">PyTree</span></span></span><a class="headerlink" href="#waymax.datatypes.update_by_slice_in_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Updates a slice in inputs using slices from updates.</p>
<p>It replaces inputs[inputs_start_idx:inputs_start_idx+slice_size] by
updates[updates_start_idx:updates_start_idx+slice_size] for specified axis
only.</p>
<p>If updates_start_idx and slice_size are both None, the behavior of this
function will default to dynamic_update_slice_in_dim.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> – Represents the data to be updated and returned.</p></li>
<li><p><strong>updates</strong> – Represents the data that is passed in to update all fields. It is
assumed that the <cite>updates</cite> and the <cite>inputs</cite> have the same structure.</p></li>
<li><p><strong>inputs_start_idx</strong> – starting index in inputs.</p></li>
<li><p><strong>updates_start_idx</strong> – starting index in updates.</p></li>
<li><p><strong>slice_size</strong> – the slice size used for update. If slice size is None, uses the
entire array and updates_start_idx will be ignored.</p></li>
<li><p><strong>axis</strong> – Axis of each array to perform the slicing in.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A PyTree with same structure as inputs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="waymax.datatypes.filter_topk_roadgraph_points">
<span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">filter_topk_roadgraph_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">roadgraph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#waymax.datatypes.RoadgraphPoints" title="waymax.datatypes.RoadgraphPoints"><span class="pre">RoadgraphPoints</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topk</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#waymax.datatypes.RoadgraphPoints" title="waymax.datatypes.RoadgraphPoints"><span class="pre">RoadgraphPoints</span></a></span></span><a class="headerlink" href="#waymax.datatypes.filter_topk_roadgraph_points" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the topk closest roadgraph points to a reference point.</p>
<p>If <cite>topk</cite> is larger than the number of points, exception will be raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>roadgraph</strong> – Roadgraph information to filter, (…, num_points).</p></li>
<li><p><strong>reference_points</strong> – A tensor of shape (…, 2) - the reference point used to
measure distance.</p></li>
<li><p><strong>topk</strong> – Number of points to keep.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Roadgraph data structure that has been filtered to only contain the <cite>topk</cite></dt><dd><p>closest points to a reference point.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="waymax.datatypes.is_road_edge">
<span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">is_road_edge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">types</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">jax.Array</span></span></span><a class="headerlink" href="#waymax.datatypes.is_road_edge" title="Permalink to this definition">#</a></dt>
<dd><p>Determines which map elements in a tensor are road edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>types</strong> – <p>An array of integer values with each integer value representing a
unique map type. These integers are based on a schema defined in
<a class="reference external" href="https://waymo.com/open/data/motion/tfexample">https://waymo.com/open/data/motion/tfexample</a>. This is of shape (…,</p>
<blockquote>
<div><p>num_points).</p>
</div></blockquote>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A bool array where an element is true if the map element is a road edge.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="waymax.datatypes.MapElementIds">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">MapElementIds</span></span><a class="headerlink" href="#waymax.datatypes.MapElementIds" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">enum.IntEnum</span></code></p>
<p>Ids for different map elements to be mapped into a tensor.</p>
<dl class="simple">
<dt>These integers represent the ID of these specific types as defined in:</dt><dd><p><a class="reference external" href="https://waymo.com/open/data/motion/tfexample">https://waymo.com/open/data/motion/tfexample</a>.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.MapElementIds.LANE_UNDEFINED">
<span class="sig-name descname"><span class="pre">LANE_UNDEFINED</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#waymax.datatypes.MapElementIds.LANE_UNDEFINED" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.MapElementIds.LANE_FREEWAY">
<span class="sig-name descname"><span class="pre">LANE_FREEWAY</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#waymax.datatypes.MapElementIds.LANE_FREEWAY" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.MapElementIds.LANE_SURFACE_STREET">
<span class="sig-name descname"><span class="pre">LANE_SURFACE_STREET</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#waymax.datatypes.MapElementIds.LANE_SURFACE_STREET" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.MapElementIds.LANE_BIKE_LANE">
<span class="sig-name descname"><span class="pre">LANE_BIKE_LANE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#waymax.datatypes.MapElementIds.LANE_BIKE_LANE" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.MapElementIds.ROAD_LINE_UNKNOWN">
<span class="sig-name descname"><span class="pre">ROAD_LINE_UNKNOWN</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">5</span></em><a class="headerlink" href="#waymax.datatypes.MapElementIds.ROAD_LINE_UNKNOWN" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.MapElementIds.ROAD_LINE_BROKEN_SINGLE_WHITE">
<span class="sig-name descname"><span class="pre">ROAD_LINE_BROKEN_SINGLE_WHITE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">6</span></em><a class="headerlink" href="#waymax.datatypes.MapElementIds.ROAD_LINE_BROKEN_SINGLE_WHITE" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.MapElementIds.ROAD_LINE_SOLID_SINGLE_WHITE">
<span class="sig-name descname"><span class="pre">ROAD_LINE_SOLID_SINGLE_WHITE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">7</span></em><a class="headerlink" href="#waymax.datatypes.MapElementIds.ROAD_LINE_SOLID_SINGLE_WHITE" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.MapElementIds.ROAD_LINE_SOLID_DOUBLE_WHITE">
<span class="sig-name descname"><span class="pre">ROAD_LINE_SOLID_DOUBLE_WHITE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">8</span></em><a class="headerlink" href="#waymax.datatypes.MapElementIds.ROAD_LINE_SOLID_DOUBLE_WHITE" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.MapElementIds.ROAD_LINE_BROKEN_SINGLE_YELLOW">
<span class="sig-name descname"><span class="pre">ROAD_LINE_BROKEN_SINGLE_YELLOW</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">9</span></em><a class="headerlink" href="#waymax.datatypes.MapElementIds.ROAD_LINE_BROKEN_SINGLE_YELLOW" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.MapElementIds.ROAD_LINE_BROKEN_DOUBLE_YELLOW">
<span class="sig-name descname"><span class="pre">ROAD_LINE_BROKEN_DOUBLE_YELLOW</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">10</span></em><a class="headerlink" href="#waymax.datatypes.MapElementIds.ROAD_LINE_BROKEN_DOUBLE_YELLOW" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.MapElementIds.ROAD_LINE_SOLID_SINGLE_YELLOW">
<span class="sig-name descname"><span class="pre">ROAD_LINE_SOLID_SINGLE_YELLOW</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">11</span></em><a class="headerlink" href="#waymax.datatypes.MapElementIds.ROAD_LINE_SOLID_SINGLE_YELLOW" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.MapElementIds.ROAD_LINE_SOLID_DOUBLE_YELLOW">
<span class="sig-name descname"><span class="pre">ROAD_LINE_SOLID_DOUBLE_YELLOW</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">12</span></em><a class="headerlink" href="#waymax.datatypes.MapElementIds.ROAD_LINE_SOLID_DOUBLE_YELLOW" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.MapElementIds.ROAD_LINE_PASSING_DOUBLE_YELLOW">
<span class="sig-name descname"><span class="pre">ROAD_LINE_PASSING_DOUBLE_YELLOW</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">13</span></em><a class="headerlink" href="#waymax.datatypes.MapElementIds.ROAD_LINE_PASSING_DOUBLE_YELLOW" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.MapElementIds.ROAD_EDGE_UNKNOWN">
<span class="sig-name descname"><span class="pre">ROAD_EDGE_UNKNOWN</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">14</span></em><a class="headerlink" href="#waymax.datatypes.MapElementIds.ROAD_EDGE_UNKNOWN" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.MapElementIds.ROAD_EDGE_BOUNDARY">
<span class="sig-name descname"><span class="pre">ROAD_EDGE_BOUNDARY</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">15</span></em><a class="headerlink" href="#waymax.datatypes.MapElementIds.ROAD_EDGE_BOUNDARY" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.MapElementIds.ROAD_EDGE_MEDIAN">
<span class="sig-name descname"><span class="pre">ROAD_EDGE_MEDIAN</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">16</span></em><a class="headerlink" href="#waymax.datatypes.MapElementIds.ROAD_EDGE_MEDIAN" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.MapElementIds.STOP_SIGN">
<span class="sig-name descname"><span class="pre">STOP_SIGN</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">17</span></em><a class="headerlink" href="#waymax.datatypes.MapElementIds.STOP_SIGN" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.MapElementIds.CROSSWALK">
<span class="sig-name descname"><span class="pre">CROSSWALK</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">18</span></em><a class="headerlink" href="#waymax.datatypes.MapElementIds.CROSSWALK" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.MapElementIds.SPEED_BUMP">
<span class="sig-name descname"><span class="pre">SPEED_BUMP</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">19</span></em><a class="headerlink" href="#waymax.datatypes.MapElementIds.SPEED_BUMP" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.MapElementIds.UNKNOWN">
<span class="sig-name descname"><span class="pre">UNKNOWN</span></span><a class="headerlink" href="#waymax.datatypes.MapElementIds.UNKNOWN" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="waymax.datatypes.RoadgraphPoints">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">RoadgraphPoints</span></span><a class="headerlink" href="#waymax.datatypes.RoadgraphPoints" title="Permalink to this definition">#</a></dt>
<dd><p>Data structure representing roadgraph points.</p>
<p>It holds the coordinates of the sampled map data points.  Note all attributes
have shape (…, num_points), where num_points is the
number of road graph points.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.RoadgraphPoints.x">
<span class="sig-name descname"><span class="pre">x</span></span><a class="headerlink" href="#waymax.datatypes.RoadgraphPoints.x" title="Permalink to this definition">#</a></dt>
<dd><p>X coordinate of positions of the sampled map data points of dtype
float32.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.RoadgraphPoints.y">
<span class="sig-name descname"><span class="pre">y</span></span><a class="headerlink" href="#waymax.datatypes.RoadgraphPoints.y" title="Permalink to this definition">#</a></dt>
<dd><p>Y coordinate of positions of the sampled map data points of dtype
float32.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.RoadgraphPoints.z">
<span class="sig-name descname"><span class="pre">z</span></span><a class="headerlink" href="#waymax.datatypes.RoadgraphPoints.z" title="Permalink to this definition">#</a></dt>
<dd><p>Z coordinate of positions of the sampled map data points of dtype
float32.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.RoadgraphPoints.dir_x">
<span class="sig-name descname"><span class="pre">dir_x</span></span><a class="headerlink" href="#waymax.datatypes.RoadgraphPoints.dir_x" title="Permalink to this definition">#</a></dt>
<dd><p>X coordinate of a unit direction vector for each map feature sample
point of dtype float32.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.RoadgraphPoints.dir_y">
<span class="sig-name descname"><span class="pre">dir_y</span></span><a class="headerlink" href="#waymax.datatypes.RoadgraphPoints.dir_y" title="Permalink to this definition">#</a></dt>
<dd><p>Y coordinate of a unit direction vector for each map feature sample
point of dtype float32.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.RoadgraphPoints.dir_z">
<span class="sig-name descname"><span class="pre">dir_z</span></span><a class="headerlink" href="#waymax.datatypes.RoadgraphPoints.dir_z" title="Permalink to this definition">#</a></dt>
<dd><p>Z coordinate of a unit direction vector for each map feature sample
point of dtype float32.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.RoadgraphPoints.types">
<span class="sig-name descname"><span class="pre">types</span></span><a class="headerlink" href="#waymax.datatypes.RoadgraphPoints.types" title="Permalink to this definition">#</a></dt>
<dd><p>A unique integer for each combination of map feature type and
properties of dtype int32. See the table in the Value Range column of
website: <a class="reference external" href="https://waymo.com/open/data/motion/tfexample">https://waymo.com/open/data/motion/tfexample</a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.RoadgraphPoints.ids">
<span class="sig-name descname"><span class="pre">ids</span></span><a class="headerlink" href="#waymax.datatypes.RoadgraphPoints.ids" title="Permalink to this definition">#</a></dt>
<dd><p>A unique Integer ID for the vector map feature each sample is from of
dtype int32.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.RoadgraphPoints.valid">
<span class="sig-name descname"><span class="pre">valid</span></span><a class="headerlink" href="#waymax.datatypes.RoadgraphPoints.valid" title="Permalink to this definition">#</a></dt>
<dd><p>A valid flag for each map sample point of dtype bool.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.RoadgraphPoints.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Ellipsis</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#waymax.datatypes.RoadgraphPoints.shape" title="Permalink to this definition">#</a></dt>
<dd><p>The Array shape of the RoadgraphPoints.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.RoadgraphPoints.num_points">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_points</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#waymax.datatypes.RoadgraphPoints.num_points" title="Permalink to this definition">#</a></dt>
<dd><p>The number of points included in this RoadgraphPoints per example.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.RoadgraphPoints.xy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#waymax.datatypes.RoadgraphPoints.xy" title="Permalink to this definition">#</a></dt>
<dd><p>Stacked xy location for all points.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.RoadgraphPoints.xyz">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xyz</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#waymax.datatypes.RoadgraphPoints.xyz" title="Permalink to this definition">#</a></dt>
<dd><p>Stacked xyz location for all points.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.RoadgraphPoints.dir_xy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dir_xy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#waymax.datatypes.RoadgraphPoints.dir_xy" title="Permalink to this definition">#</a></dt>
<dd><p>Stacked xy direction for all points.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.RoadgraphPoints.dir_xyz">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dir_xyz</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#waymax.datatypes.RoadgraphPoints.dir_xyz" title="Permalink to this definition">#</a></dt>
<dd><p>Stacked xy direction for all points.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id34">
<span class="sig-name descname"><span class="pre">x</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id34" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id35">
<span class="sig-name descname"><span class="pre">y</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id35" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id36">
<span class="sig-name descname"><span class="pre">z</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id36" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id37">
<span class="sig-name descname"><span class="pre">dir_x</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id37" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id38">
<span class="sig-name descname"><span class="pre">dir_y</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id38" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id39">
<span class="sig-name descname"><span class="pre">dir_z</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id39" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id40">
<span class="sig-name descname"><span class="pre">types</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id40" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id41">
<span class="sig-name descname"><span class="pre">ids</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id41" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id42">
<span class="sig-name descname"><span class="pre">valid</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id42" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.datatypes.RoadgraphPoints.__eq__">
<span class="sig-name descname"><span class="pre">__eq__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#waymax.datatypes.RoadgraphPoints.__eq__" title="Permalink to this definition">#</a></dt>
<dd><p>Return self==value.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.datatypes.RoadgraphPoints.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#waymax.datatypes.RoadgraphPoints.validate" title="Permalink to this definition">#</a></dt>
<dd><p>Validates shape and type.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="waymax.datatypes.Paths">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">Paths</span></span><a class="headerlink" href="#waymax.datatypes.Paths" title="Permalink to this definition">#</a></dt>
<dd><p>Data structure for a set of paths represented by roadgraph points.</p>
<p>A <cite>path</cite> consists of a set of roadgraph points (usually along the lane center)
and represents where an object can legally traverse giving its starting point.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.Paths.x">
<span class="sig-name descname"><span class="pre">x</span></span><a class="headerlink" href="#waymax.datatypes.Paths.x" title="Permalink to this definition">#</a></dt>
<dd><p>Path coordinate x, shape is (…, num_paths, num_points_per_path) and
dtype is float32.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.Paths.y">
<span class="sig-name descname"><span class="pre">y</span></span><a class="headerlink" href="#waymax.datatypes.Paths.y" title="Permalink to this definition">#</a></dt>
<dd><p>Path coordinate y, shape is (…, num_paths, num_points_per_path) and
dtype is float32.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.Paths.z">
<span class="sig-name descname"><span class="pre">z</span></span><a class="headerlink" href="#waymax.datatypes.Paths.z" title="Permalink to this definition">#</a></dt>
<dd><p>Path coordinate z, shape is (…, num_paths, num_points_per_path) and
dtype is float32.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.Paths.ids">
<span class="sig-name descname"><span class="pre">ids</span></span><a class="headerlink" href="#waymax.datatypes.Paths.ids" title="Permalink to this definition">#</a></dt>
<dd><p>IDs representing which lane the points belong to, shape is (…,
num_paths, num_points_per_path) and dtype is int32.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.Paths.valid">
<span class="sig-name descname"><span class="pre">valid</span></span><a class="headerlink" href="#waymax.datatypes.Paths.valid" title="Permalink to this definition">#</a></dt>
<dd><p>Validity flag, shape is (…, num_paths, num_points_per_path) and
dtype is bool.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.Paths.arc_length">
<span class="sig-name descname"><span class="pre">arc_length</span></span><a class="headerlink" href="#waymax.datatypes.Paths.arc_length" title="Permalink to this definition">#</a></dt>
<dd><p>Represents the arc length for each point from the starting point
along the path with shape (…, num_paths, num_points_per_path) and dtype
is float32.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.Paths.on_route">
<span class="sig-name descname"><span class="pre">on_route</span></span><a class="headerlink" href="#waymax.datatypes.Paths.on_route" title="Permalink to this definition">#</a></dt>
<dd><p>Flag for each path representing whether it is on the road route
corresponding to the logged trajectory, shape is (…, num_paths, 1) and
the dtype is bool.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.Paths.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Ellipsis</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#waymax.datatypes.Paths.shape" title="Permalink to this definition">#</a></dt>
<dd><p>The Array shape of the routes.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.Paths.num_points_per_path">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_points_per_path</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#waymax.datatypes.Paths.num_points_per_path" title="Permalink to this definition">#</a></dt>
<dd><p>The number of points included in the paths per example.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.Paths.num_paths">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_paths</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#waymax.datatypes.Paths.num_paths" title="Permalink to this definition">#</a></dt>
<dd><p>The number of paths included in the example.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.Paths.xy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#waymax.datatypes.Paths.xy" title="Permalink to this definition">#</a></dt>
<dd><p>Stacked xy location for all points.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.Paths.xyz">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xyz</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#waymax.datatypes.Paths.xyz" title="Permalink to this definition">#</a></dt>
<dd><p>Stacked xyz location for all points.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id43">
<span class="sig-name descname"><span class="pre">x</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id43" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id44">
<span class="sig-name descname"><span class="pre">y</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id44" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id45">
<span class="sig-name descname"><span class="pre">z</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id45" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id46">
<span class="sig-name descname"><span class="pre">ids</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id46" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id47">
<span class="sig-name descname"><span class="pre">valid</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id47" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id48">
<span class="sig-name descname"><span class="pre">arc_length</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id48" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id49">
<span class="sig-name descname"><span class="pre">on_route</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id49" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.datatypes.Paths.__eq__">
<span class="sig-name descname"><span class="pre">__eq__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#waymax.datatypes.Paths.__eq__" title="Permalink to this definition">#</a></dt>
<dd><p>Return self==value.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.datatypes.Paths.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#waymax.datatypes.Paths.validate" title="Permalink to this definition">#</a></dt>
<dd><p>Validates shape and type.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="waymax.datatypes.get_control_mask">
<span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">get_control_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="object_state/index.html#waymax.datatypes.object_state.ObjectMetadata" title="waymax.datatypes.object_state.ObjectMetadata"><span class="pre">waymax.datatypes.object_state.ObjectMetadata</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../config/index.html#waymax.config.ObjectType" title="waymax.config.ObjectType"><span class="pre">waymax.config.ObjectType</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">jax.Array</span></span></span><a class="headerlink" href="#waymax.datatypes.get_control_mask" title="Permalink to this definition">#</a></dt>
<dd><p>Returns binary mask for selected object type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metadata</strong> – An ObjectMetadata, having shape (…, num_objects).</p></li>
<li><p><strong>obj_type</strong> – Represents which type of objects should be selected.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A binary mask with shape (…, num_objects).</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="waymax.datatypes.SimulatorState">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">SimulatorState</span></span><a class="headerlink" href="#waymax.datatypes.SimulatorState" title="Permalink to this definition">#</a></dt>
<dd><p>A dataclass holding the simulator state, all data in global coordinates.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.SimulatorState.sim_trajectory">
<span class="sig-name descname"><span class="pre">sim_trajectory</span></span><a class="headerlink" href="#waymax.datatypes.SimulatorState.sim_trajectory" title="Permalink to this definition">#</a></dt>
<dd><p>Simulated trajectory for all objects of shape (…,
num_objects, num_timesteps). The number of timesteps is the same as in the
log, but future trajectory points that have not been simulated will be
marked invalid.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.SimulatorState.log_trajectory">
<span class="sig-name descname"><span class="pre">log_trajectory</span></span><a class="headerlink" href="#waymax.datatypes.SimulatorState.log_trajectory" title="Permalink to this definition">#</a></dt>
<dd><p>Logged trajectory for all objects of shape (…,
num_objects, num_timesteps).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.SimulatorState.log_traffic_light">
<span class="sig-name descname"><span class="pre">log_traffic_light</span></span><a class="headerlink" href="#waymax.datatypes.SimulatorState.log_traffic_light" title="Permalink to this definition">#</a></dt>
<dd><p>Logged traffic light information for the entire run
segment of shape (…, num_traffic_lights, num_timesteps).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.SimulatorState.object_metadata">
<span class="sig-name descname"><span class="pre">object_metadata</span></span><a class="headerlink" href="#waymax.datatypes.SimulatorState.object_metadata" title="Permalink to this definition">#</a></dt>
<dd><p>Metadata for all objects of shape (…, num_objects).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.SimulatorState.timestep">
<span class="sig-name descname"><span class="pre">timestep</span></span><a class="headerlink" href="#waymax.datatypes.SimulatorState.timestep" title="Permalink to this definition">#</a></dt>
<dd><p>The current simulation timestep index of shape (…). Note that
sim_trajectory at <cite>timestep</cite> is the last executed step by the simulator.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.SimulatorState.sdc_paths">
<span class="sig-name descname"><span class="pre">sdc_paths</span></span><a class="headerlink" href="#waymax.datatypes.SimulatorState.sdc_paths" title="Permalink to this definition">#</a></dt>
<dd><p>Paths for SDC, representing where the SDC can drive of shape
(…, num_paths, num_points_per_path).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.SimulatorState.roadgraph_points">
<span class="sig-name descname"><span class="pre">roadgraph_points</span></span><a class="headerlink" href="#waymax.datatypes.SimulatorState.roadgraph_points" title="Permalink to this definition">#</a></dt>
<dd><p>A optional RoadgraphPoints holding subsampled roadgraph
points of shape (…, num_points).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.SimulatorState.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Ellipsis</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#waymax.datatypes.SimulatorState.shape" title="Permalink to this definition">#</a></dt>
<dd><p>Shape is defined as the most common prefix shape of all attributes.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.SimulatorState.batch_dims">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">batch_dims</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Ellipsis</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#waymax.datatypes.SimulatorState.batch_dims" title="Permalink to this definition">#</a></dt>
<dd><p>Batch dimensions.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.SimulatorState.num_objects">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_objects</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#waymax.datatypes.SimulatorState.num_objects" title="Permalink to this definition">#</a></dt>
<dd><p>The number of objects included in this trajectory per example.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.SimulatorState.is_done">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_done</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#waymax.datatypes.SimulatorState.is_done" title="Permalink to this definition">#</a></dt>
<dd><p>Returns whether the simulation is at the end of the logged history.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.SimulatorState.remaining_timesteps">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">remaining_timesteps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#waymax.datatypes.SimulatorState.remaining_timesteps" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the number of remaining timesteps in the episode.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.SimulatorState.current_sim_trajectory">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">current_sim_trajectory</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="object_state/index.html#waymax.datatypes.object_state.Trajectory" title="waymax.datatypes.object_state.Trajectory"><span class="pre">waymax.datatypes.object_state.Trajectory</span></a></em><a class="headerlink" href="#waymax.datatypes.SimulatorState.current_sim_trajectory" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the trajectory corresponding to the current sim state.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.SimulatorState.current_log_trajectory">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">current_log_trajectory</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="object_state/index.html#waymax.datatypes.object_state.Trajectory" title="waymax.datatypes.object_state.Trajectory"><span class="pre">waymax.datatypes.object_state.Trajectory</span></a></em><a class="headerlink" href="#waymax.datatypes.SimulatorState.current_log_trajectory" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the trajectory corresponding to the current sim state.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id50">
<span class="sig-name descname"><span class="pre">sim_trajectory</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="object_state/index.html#waymax.datatypes.object_state.Trajectory" title="waymax.datatypes.object_state.Trajectory"><span class="pre">waymax.datatypes.object_state.Trajectory</span></a></em><a class="headerlink" href="#id50" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id51">
<span class="sig-name descname"><span class="pre">log_trajectory</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="object_state/index.html#waymax.datatypes.object_state.Trajectory" title="waymax.datatypes.object_state.Trajectory"><span class="pre">waymax.datatypes.object_state.Trajectory</span></a></em><a class="headerlink" href="#id51" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id52">
<span class="sig-name descname"><span class="pre">log_traffic_light</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="traffic_lights/index.html#waymax.datatypes.traffic_lights.TrafficLights" title="waymax.datatypes.traffic_lights.TrafficLights"><span class="pre">waymax.datatypes.traffic_lights.TrafficLights</span></a></em><a class="headerlink" href="#id52" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id53">
<span class="sig-name descname"><span class="pre">object_metadata</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="object_state/index.html#waymax.datatypes.object_state.ObjectMetadata" title="waymax.datatypes.object_state.ObjectMetadata"><span class="pre">waymax.datatypes.object_state.ObjectMetadata</span></a></em><a class="headerlink" href="#id53" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id54">
<span class="sig-name descname"><span class="pre">timestep</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.typing.ArrayLike</span></em><a class="headerlink" href="#id54" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id55">
<span class="sig-name descname"><span class="pre">sdc_paths</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="route/index.html#waymax.datatypes.route.Paths" title="waymax.datatypes.route.Paths"><span class="pre">waymax.datatypes.route.Paths</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id55" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id56">
<span class="sig-name descname"><span class="pre">roadgraph_points</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="roadgraph/index.html#waymax.datatypes.roadgraph.RoadgraphPoints" title="waymax.datatypes.roadgraph.RoadgraphPoints"><span class="pre">waymax.datatypes.roadgraph.RoadgraphPoints</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id56" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.datatypes.SimulatorState.__eq__">
<span class="sig-name descname"><span class="pre">__eq__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#waymax.datatypes.SimulatorState.__eq__" title="Permalink to this definition">#</a></dt>
<dd><p>Return self==value.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.datatypes.SimulatorState.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#waymax.datatypes.SimulatorState.validate" title="Permalink to this definition">#</a></dt>
<dd><p>Validates shape and type.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="waymax.datatypes.update_state_by_log">
<span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">update_state_by_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#waymax.datatypes.SimulatorState" title="waymax.datatypes.SimulatorState"><span class="pre">SimulatorState</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#waymax.datatypes.SimulatorState" title="waymax.datatypes.SimulatorState"><span class="pre">SimulatorState</span></a></span></span><a class="headerlink" href="#waymax.datatypes.update_state_by_log" title="Permalink to this definition">#</a></dt>
<dd><p>Advances SimulatorState by num_steps using logged data.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="waymax.datatypes.TrafficLights">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">TrafficLights</span></span><a class="headerlink" href="#waymax.datatypes.TrafficLights" title="Permalink to this definition">#</a></dt>
<dd><p>Data structure representing the dynamic traffic light state information.</p>
<p>All attributes have shape (…, num_traffic_lights, num_timesteps).</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.TrafficLights.x">
<span class="sig-name descname"><span class="pre">x</span></span><a class="headerlink" href="#waymax.datatypes.TrafficLights.x" title="Permalink to this definition">#</a></dt>
<dd><p>The X coordinate of the stop light position of dtype float32.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.TrafficLights.y">
<span class="sig-name descname"><span class="pre">y</span></span><a class="headerlink" href="#waymax.datatypes.TrafficLights.y" title="Permalink to this definition">#</a></dt>
<dd><p>The Y coordinate of the stop light position of dtype float32.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.TrafficLights.z">
<span class="sig-name descname"><span class="pre">z</span></span><a class="headerlink" href="#waymax.datatypes.TrafficLights.z" title="Permalink to this definition">#</a></dt>
<dd><p>The Z coordinate of the stop light position. This point is at the
beginning of the lane segment controlled by the traffic signal of dtype
float32.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.TrafficLights.state">
<span class="sig-name descname"><span class="pre">state</span></span><a class="headerlink" href="#waymax.datatypes.TrafficLights.state" title="Permalink to this definition">#</a></dt>
<dd><p>The state of each traffic light at each time step of dtype int32. See
above enum for integer values of all traffic lights states.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.TrafficLights.lane_ids">
<span class="sig-name descname"><span class="pre">lane_ids</span></span><a class="headerlink" href="#waymax.datatypes.TrafficLights.lane_ids" title="Permalink to this definition">#</a></dt>
<dd><p>which lane it controls.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.TrafficLights.valid">
<span class="sig-name descname"><span class="pre">valid</span></span><a class="headerlink" href="#waymax.datatypes.TrafficLights.valid" title="Permalink to this definition">#</a></dt>
<dd><p>A valid flag for all elements of features traffic_light.XX. If set to
True, the element is populated with valid data.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.TrafficLights.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Ellipsis</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#waymax.datatypes.TrafficLights.shape" title="Permalink to this definition">#</a></dt>
<dd><p>The tensor shape of the traffic lights.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.TrafficLights.num_traffic_lights">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_traffic_lights</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#waymax.datatypes.TrafficLights.num_traffic_lights" title="Permalink to this definition">#</a></dt>
<dd><p>The number of points included in this traffic light per example.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.TrafficLights.num_timesteps">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_timesteps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#waymax.datatypes.TrafficLights.num_timesteps" title="Permalink to this definition">#</a></dt>
<dd><p>The number of timesteps included in this traffic light per example.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="waymax.datatypes.TrafficLights.xy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#waymax.datatypes.TrafficLights.xy" title="Permalink to this definition">#</a></dt>
<dd><p>Stacked xy location for all points.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id57">
<span class="sig-name descname"><span class="pre">x</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id57" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id58">
<span class="sig-name descname"><span class="pre">y</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id58" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id59">
<span class="sig-name descname"><span class="pre">z</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id59" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id60">
<span class="sig-name descname"><span class="pre">state</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id60" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id61">
<span class="sig-name descname"><span class="pre">lane_ids</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id61" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id62">
<span class="sig-name descname"><span class="pre">valid</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jax.Array</span></em><a class="headerlink" href="#id62" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.datatypes.TrafficLights.__eq__">
<span class="sig-name descname"><span class="pre">__eq__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#waymax.datatypes.TrafficLights.__eq__" title="Permalink to this definition">#</a></dt>
<dd><p>Return self==value.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.datatypes.TrafficLights.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#waymax.datatypes.TrafficLights.validate" title="Permalink to this definition">#</a></dt>
<dd><p>Validates shape and type.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="waymax.datatypes.TrafficLightStates">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">waymax.datatypes.</span></span><span class="sig-name descname"><span class="pre">TrafficLightStates</span></span><a class="headerlink" href="#waymax.datatypes.TrafficLightStates" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">enum.IntEnum</span></code></p>
<p>Represents the integer values for all Traffic Light State values.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.TrafficLightStates.UNKNOWN">
<span class="sig-name descname"><span class="pre">UNKNOWN</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#waymax.datatypes.TrafficLightStates.UNKNOWN" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.TrafficLightStates.ARROW_STOP">
<span class="sig-name descname"><span class="pre">ARROW_STOP</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#waymax.datatypes.TrafficLightStates.ARROW_STOP" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.TrafficLightStates.ARROW_CAUTION">
<span class="sig-name descname"><span class="pre">ARROW_CAUTION</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#waymax.datatypes.TrafficLightStates.ARROW_CAUTION" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.TrafficLightStates.ARROW_GO">
<span class="sig-name descname"><span class="pre">ARROW_GO</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#waymax.datatypes.TrafficLightStates.ARROW_GO" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.TrafficLightStates.STOP">
<span class="sig-name descname"><span class="pre">STOP</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4</span></em><a class="headerlink" href="#waymax.datatypes.TrafficLightStates.STOP" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.TrafficLightStates.CAUTION">
<span class="sig-name descname"><span class="pre">CAUTION</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">5</span></em><a class="headerlink" href="#waymax.datatypes.TrafficLightStates.CAUTION" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.TrafficLightStates.GO">
<span class="sig-name descname"><span class="pre">GO</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">6</span></em><a class="headerlink" href="#waymax.datatypes.TrafficLightStates.GO" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.TrafficLightStates.FLASHING_STOP">
<span class="sig-name descname"><span class="pre">FLASHING_STOP</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">7</span></em><a class="headerlink" href="#waymax.datatypes.TrafficLightStates.FLASHING_STOP" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.datatypes.TrafficLightStates.FLASHING_CAUTION">
<span class="sig-name descname"><span class="pre">FLASHING_CAUTION</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">8</span></em><a class="headerlink" href="#waymax.datatypes.TrafficLightStates.FLASHING_CAUTION" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="action/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes.action</span></code></div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../dataloader/womd_utils/index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.dataloader.womd_utils</span></code></div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, The Waymax Authors
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes</span></code></a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#package-contents">Package Contents</a><ul>
<li><a class="reference internal" href="#classes">Classes</a></li>
<li><a class="reference internal" href="#functions">Functions</a></li>
<li><a class="reference internal" href="#attributes">Attributes</a><ul>
<li><a class="reference internal" href="#waymax.datatypes.Action"><code class="docutils literal notranslate"><span class="pre">Action</span></code></a><ul>
<li><a class="reference internal" href="#waymax.datatypes.Action.data"><code class="docutils literal notranslate"><span class="pre">Action.data</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Action.valid"><code class="docutils literal notranslate"><span class="pre">Action.valid</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Action.shape"><code class="docutils literal notranslate"><span class="pre">Action.shape</span></code></a></li>
<li><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">Action.data</span></code></a></li>
<li><a class="reference internal" href="#id1"><code class="docutils literal notranslate"><span class="pre">Action.valid</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Action.__eq__"><code class="docutils literal notranslate"><span class="pre">Action.__eq__()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Action.validate"><code class="docutils literal notranslate"><span class="pre">Action.validate()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#waymax.datatypes.TrajectoryUpdate"><code class="docutils literal notranslate"><span class="pre">TrajectoryUpdate</span></code></a><ul>
<li><a class="reference internal" href="#waymax.datatypes.TrajectoryUpdate.shape"><code class="docutils literal notranslate"><span class="pre">TrajectoryUpdate.shape</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.TrajectoryUpdate.x"><code class="docutils literal notranslate"><span class="pre">TrajectoryUpdate.x</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.TrajectoryUpdate.y"><code class="docutils literal notranslate"><span class="pre">TrajectoryUpdate.y</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.TrajectoryUpdate.yaw"><code class="docutils literal notranslate"><span class="pre">TrajectoryUpdate.yaw</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.TrajectoryUpdate.vel_x"><code class="docutils literal notranslate"><span class="pre">TrajectoryUpdate.vel_x</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.TrajectoryUpdate.vel_y"><code class="docutils literal notranslate"><span class="pre">TrajectoryUpdate.vel_y</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.TrajectoryUpdate.valid"><code class="docutils literal notranslate"><span class="pre">TrajectoryUpdate.valid</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.TrajectoryUpdate.__eq__"><code class="docutils literal notranslate"><span class="pre">TrajectoryUpdate.__eq__()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.TrajectoryUpdate.validate"><code class="docutils literal notranslate"><span class="pre">TrajectoryUpdate.validate()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.TrajectoryUpdate.as_action"><code class="docutils literal notranslate"><span class="pre">TrajectoryUpdate.as_action()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#waymax.datatypes.MaskedArray"><code class="docutils literal notranslate"><span class="pre">MaskedArray</span></code></a><ul>
<li><a class="reference internal" href="#waymax.datatypes.MaskedArray.value"><code class="docutils literal notranslate"><span class="pre">MaskedArray.value</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.MaskedArray.valid"><code class="docutils literal notranslate"><span class="pre">MaskedArray.valid</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.MaskedArray.shape"><code class="docutils literal notranslate"><span class="pre">MaskedArray.shape</span></code></a></li>
<li><a class="reference internal" href="#id2"><code class="docutils literal notranslate"><span class="pre">MaskedArray.value</span></code></a></li>
<li><a class="reference internal" href="#id3"><code class="docutils literal notranslate"><span class="pre">MaskedArray.valid</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.MaskedArray.__eq__"><code class="docutils literal notranslate"><span class="pre">MaskedArray.__eq__()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.MaskedArray.validate"><code class="docutils literal notranslate"><span class="pre">MaskedArray.validate()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.MaskedArray.create_and_validate"><code class="docutils literal notranslate"><span class="pre">MaskedArray.create_and_validate()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.MaskedArray.masked_value"><code class="docutils literal notranslate"><span class="pre">MaskedArray.masked_value()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#waymax.datatypes.PyTree"><code class="docutils literal notranslate"><span class="pre">PyTree</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.TIME_INTERVAL"><code class="docutils literal notranslate"><span class="pre">TIME_INTERVAL</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.TIMESTEP_MICROS_INTERVAL"><code class="docutils literal notranslate"><span class="pre">TIMESTEP_MICROS_INTERVAL</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.fill_invalid_trajectory"><code class="docutils literal notranslate"><span class="pre">fill_invalid_trajectory()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.ObjectMetadata"><code class="docutils literal notranslate"><span class="pre">ObjectMetadata</span></code></a><ul>
<li><a class="reference internal" href="#waymax.datatypes.ObjectMetadata.ids"><code class="docutils literal notranslate"><span class="pre">ObjectMetadata.ids</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.ObjectMetadata.object_types"><code class="docutils literal notranslate"><span class="pre">ObjectMetadata.object_types</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.ObjectMetadata.is_sdc"><code class="docutils literal notranslate"><span class="pre">ObjectMetadata.is_sdc</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.ObjectMetadata.is_modeled"><code class="docutils literal notranslate"><span class="pre">ObjectMetadata.is_modeled</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.ObjectMetadata.is_valid"><code class="docutils literal notranslate"><span class="pre">ObjectMetadata.is_valid</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.ObjectMetadata.objects_of_interest"><code class="docutils literal notranslate"><span class="pre">ObjectMetadata.objects_of_interest</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.ObjectMetadata.is_controlled"><code class="docutils literal notranslate"><span class="pre">ObjectMetadata.is_controlled</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.ObjectMetadata.shape"><code class="docutils literal notranslate"><span class="pre">ObjectMetadata.shape</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.ObjectMetadata.num_objects"><code class="docutils literal notranslate"><span class="pre">ObjectMetadata.num_objects</span></code></a></li>
<li><a class="reference internal" href="#id4"><code class="docutils literal notranslate"><span class="pre">ObjectMetadata.ids</span></code></a></li>
<li><a class="reference internal" href="#id5"><code class="docutils literal notranslate"><span class="pre">ObjectMetadata.object_types</span></code></a></li>
<li><a class="reference internal" href="#id6"><code class="docutils literal notranslate"><span class="pre">ObjectMetadata.is_sdc</span></code></a></li>
<li><a class="reference internal" href="#id7"><code class="docutils literal notranslate"><span class="pre">ObjectMetadata.is_modeled</span></code></a></li>
<li><a class="reference internal" href="#id8"><code class="docutils literal notranslate"><span class="pre">ObjectMetadata.is_valid</span></code></a></li>
<li><a class="reference internal" href="#id9"><code class="docutils literal notranslate"><span class="pre">ObjectMetadata.objects_of_interest</span></code></a></li>
<li><a class="reference internal" href="#id10"><code class="docutils literal notranslate"><span class="pre">ObjectMetadata.is_controlled</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.ObjectMetadata.__eq__"><code class="docutils literal notranslate"><span class="pre">ObjectMetadata.__eq__()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.ObjectMetadata.validate"><code class="docutils literal notranslate"><span class="pre">ObjectMetadata.validate()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#waymax.datatypes.ObjectTypeIds"><code class="docutils literal notranslate"><span class="pre">ObjectTypeIds</span></code></a><ul>
<li><a class="reference internal" href="#waymax.datatypes.ObjectTypeIds.UNSET"><code class="docutils literal notranslate"><span class="pre">ObjectTypeIds.UNSET</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.ObjectTypeIds.VEHICLE"><code class="docutils literal notranslate"><span class="pre">ObjectTypeIds.VEHICLE</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.ObjectTypeIds.PEDESTRIAN"><code class="docutils literal notranslate"><span class="pre">ObjectTypeIds.PEDESTRIAN</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.ObjectTypeIds.CYCLIST"><code class="docutils literal notranslate"><span class="pre">ObjectTypeIds.CYCLIST</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.ObjectTypeIds.OTHER"><code class="docutils literal notranslate"><span class="pre">ObjectTypeIds.OTHER</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#waymax.datatypes.Trajectory"><code class="docutils literal notranslate"><span class="pre">Trajectory</span></code></a><ul>
<li><a class="reference internal" href="#waymax.datatypes.Trajectory.x"><code class="docutils literal notranslate"><span class="pre">Trajectory.x</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Trajectory.y"><code class="docutils literal notranslate"><span class="pre">Trajectory.y</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Trajectory.z"><code class="docutils literal notranslate"><span class="pre">Trajectory.z</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Trajectory.vel_x"><code class="docutils literal notranslate"><span class="pre">Trajectory.vel_x</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Trajectory.vel_y"><code class="docutils literal notranslate"><span class="pre">Trajectory.vel_y</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Trajectory.yaw"><code class="docutils literal notranslate"><span class="pre">Trajectory.yaw</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Trajectory.valid"><code class="docutils literal notranslate"><span class="pre">Trajectory.valid</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Trajectory.timestamp_micros"><code class="docutils literal notranslate"><span class="pre">Trajectory.timestamp_micros</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Trajectory.length"><code class="docutils literal notranslate"><span class="pre">Trajectory.length</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Trajectory.width"><code class="docutils literal notranslate"><span class="pre">Trajectory.width</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Trajectory.height"><code class="docutils literal notranslate"><span class="pre">Trajectory.height</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Trajectory.shape"><code class="docutils literal notranslate"><span class="pre">Trajectory.shape</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Trajectory.num_objects"><code class="docutils literal notranslate"><span class="pre">Trajectory.num_objects</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Trajectory.num_timesteps"><code class="docutils literal notranslate"><span class="pre">Trajectory.num_timesteps</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Trajectory.xy"><code class="docutils literal notranslate"><span class="pre">Trajectory.xy</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Trajectory.xyz"><code class="docutils literal notranslate"><span class="pre">Trajectory.xyz</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Trajectory.vel_xy"><code class="docutils literal notranslate"><span class="pre">Trajectory.vel_xy</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Trajectory.speed"><code class="docutils literal notranslate"><span class="pre">Trajectory.speed</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Trajectory.vel_yaw"><code class="docutils literal notranslate"><span class="pre">Trajectory.vel_yaw</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Trajectory.bbox_corners"><code class="docutils literal notranslate"><span class="pre">Trajectory.bbox_corners</span></code></a></li>
<li><a class="reference internal" href="#id11"><code class="docutils literal notranslate"><span class="pre">Trajectory.x</span></code></a></li>
<li><a class="reference internal" href="#id12"><code class="docutils literal notranslate"><span class="pre">Trajectory.y</span></code></a></li>
<li><a class="reference internal" href="#id13"><code class="docutils literal notranslate"><span class="pre">Trajectory.z</span></code></a></li>
<li><a class="reference internal" href="#id14"><code class="docutils literal notranslate"><span class="pre">Trajectory.vel_x</span></code></a></li>
<li><a class="reference internal" href="#id15"><code class="docutils literal notranslate"><span class="pre">Trajectory.vel_y</span></code></a></li>
<li><a class="reference internal" href="#id16"><code class="docutils literal notranslate"><span class="pre">Trajectory.yaw</span></code></a></li>
<li><a class="reference internal" href="#id17"><code class="docutils literal notranslate"><span class="pre">Trajectory.valid</span></code></a></li>
<li><a class="reference internal" href="#id18"><code class="docutils literal notranslate"><span class="pre">Trajectory.timestamp_micros</span></code></a></li>
<li><a class="reference internal" href="#id19"><code class="docutils literal notranslate"><span class="pre">Trajectory.length</span></code></a></li>
<li><a class="reference internal" href="#id20"><code class="docutils literal notranslate"><span class="pre">Trajectory.width</span></code></a></li>
<li><a class="reference internal" href="#id21"><code class="docutils literal notranslate"><span class="pre">Trajectory.height</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Trajectory.__eq__"><code class="docutils literal notranslate"><span class="pre">Trajectory.__eq__()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Trajectory.stack_fields"><code class="docutils literal notranslate"><span class="pre">Trajectory.stack_fields()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Trajectory.zeros"><code class="docutils literal notranslate"><span class="pre">Trajectory.zeros()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Trajectory.validate"><code class="docutils literal notranslate"><span class="pre">Trajectory.validate()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#waymax.datatypes.ObjectPose2D"><code class="docutils literal notranslate"><span class="pre">ObjectPose2D</span></code></a><ul>
<li><a class="reference internal" href="#waymax.datatypes.ObjectPose2D.original_xy"><code class="docutils literal notranslate"><span class="pre">ObjectPose2D.original_xy</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.ObjectPose2D.original_yaw"><code class="docutils literal notranslate"><span class="pre">ObjectPose2D.original_yaw</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.ObjectPose2D.matrix"><code class="docutils literal notranslate"><span class="pre">ObjectPose2D.matrix</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.ObjectPose2D.delta_yaw"><code class="docutils literal notranslate"><span class="pre">ObjectPose2D.delta_yaw</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.ObjectPose2D.valid"><code class="docutils literal notranslate"><span class="pre">ObjectPose2D.valid</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.ObjectPose2D.shape"><code class="docutils literal notranslate"><span class="pre">ObjectPose2D.shape</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.ObjectPose2D.num_objects"><code class="docutils literal notranslate"><span class="pre">ObjectPose2D.num_objects</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.ObjectPose2D.rotation_matrix"><code class="docutils literal notranslate"><span class="pre">ObjectPose2D.rotation_matrix</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.ObjectPose2D.translation_vector"><code class="docutils literal notranslate"><span class="pre">ObjectPose2D.translation_vector</span></code></a></li>
<li><a class="reference internal" href="#id22"><code class="docutils literal notranslate"><span class="pre">ObjectPose2D.original_xy</span></code></a></li>
<li><a class="reference internal" href="#id23"><code class="docutils literal notranslate"><span class="pre">ObjectPose2D.original_yaw</span></code></a></li>
<li><a class="reference internal" href="#id24"><code class="docutils literal notranslate"><span class="pre">ObjectPose2D.matrix</span></code></a></li>
<li><a class="reference internal" href="#id25"><code class="docutils literal notranslate"><span class="pre">ObjectPose2D.delta_yaw</span></code></a></li>
<li><a class="reference internal" href="#id26"><code class="docutils literal notranslate"><span class="pre">ObjectPose2D.valid</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.ObjectPose2D.__eq__"><code class="docutils literal notranslate"><span class="pre">ObjectPose2D.__eq__()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.ObjectPose2D.from_center_and_yaw"><code class="docutils literal notranslate"><span class="pre">ObjectPose2D.from_center_and_yaw()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.ObjectPose2D.from_transformation"><code class="docutils literal notranslate"><span class="pre">ObjectPose2D.from_transformation()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.ObjectPose2D.validate"><code class="docutils literal notranslate"><span class="pre">ObjectPose2D.validate()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#waymax.datatypes.Observation"><code class="docutils literal notranslate"><span class="pre">Observation</span></code></a><ul>
<li><a class="reference internal" href="#waymax.datatypes.Observation.trajectory"><code class="docutils literal notranslate"><span class="pre">Observation.trajectory</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Observation.is_ego"><code class="docutils literal notranslate"><span class="pre">Observation.is_ego</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Observation.pose2d"><code class="docutils literal notranslate"><span class="pre">Observation.pose2d</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Observation.metadata"><code class="docutils literal notranslate"><span class="pre">Observation.metadata</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Observation.roadgraph_static_points"><code class="docutils literal notranslate"><span class="pre">Observation.roadgraph_static_points</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Observation.traffic_lights"><code class="docutils literal notranslate"><span class="pre">Observation.traffic_lights</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Observation.sdc_paths"><code class="docutils literal notranslate"><span class="pre">Observation.sdc_paths</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Observation.shape"><code class="docutils literal notranslate"><span class="pre">Observation.shape</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Observation.batch_dims"><code class="docutils literal notranslate"><span class="pre">Observation.batch_dims</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Observation.num_objects"><code class="docutils literal notranslate"><span class="pre">Observation.num_objects</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Observation.valid"><code class="docutils literal notranslate"><span class="pre">Observation.valid</span></code></a></li>
<li><a class="reference internal" href="#id27"><code class="docutils literal notranslate"><span class="pre">Observation.trajectory</span></code></a></li>
<li><a class="reference internal" href="#id28"><code class="docutils literal notranslate"><span class="pre">Observation.is_ego</span></code></a></li>
<li><a class="reference internal" href="#id29"><code class="docutils literal notranslate"><span class="pre">Observation.pose2d</span></code></a></li>
<li><a class="reference internal" href="#id30"><code class="docutils literal notranslate"><span class="pre">Observation.metadata</span></code></a></li>
<li><a class="reference internal" href="#id31"><code class="docutils literal notranslate"><span class="pre">Observation.roadgraph_static_points</span></code></a></li>
<li><a class="reference internal" href="#id32"><code class="docutils literal notranslate"><span class="pre">Observation.traffic_lights</span></code></a></li>
<li><a class="reference internal" href="#id33"><code class="docutils literal notranslate"><span class="pre">Observation.sdc_paths</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Observation.for_obj"><code class="docutils literal notranslate"><span class="pre">Observation.for_obj()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Observation.validate"><code class="docutils literal notranslate"><span class="pre">Observation.validate()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#waymax.datatypes.observation_from_state"><code class="docutils literal notranslate"><span class="pre">observation_from_state()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.sdc_observation_from_state"><code class="docutils literal notranslate"><span class="pre">sdc_observation_from_state()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.transform_observation"><code class="docutils literal notranslate"><span class="pre">transform_observation()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.transform_roadgraph_points"><code class="docutils literal notranslate"><span class="pre">transform_roadgraph_points()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.transform_traffic_lights"><code class="docutils literal notranslate"><span class="pre">transform_traffic_lights()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.transform_trajectory"><code class="docutils literal notranslate"><span class="pre">transform_trajectory()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.compare_all_leaf_nodes"><code class="docutils literal notranslate"><span class="pre">compare_all_leaf_nodes()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.dynamic_index"><code class="docutils literal notranslate"><span class="pre">dynamic_index()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.dynamic_slice"><code class="docutils literal notranslate"><span class="pre">dynamic_slice()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.dynamic_update_slice_in_dim"><code class="docutils literal notranslate"><span class="pre">dynamic_update_slice_in_dim</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.make_invalid_data"><code class="docutils literal notranslate"><span class="pre">make_invalid_data()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.masked_mean"><code class="docutils literal notranslate"><span class="pre">masked_mean()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.select_by_onehot"><code class="docutils literal notranslate"><span class="pre">select_by_onehot()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.update_by_mask"><code class="docutils literal notranslate"><span class="pre">update_by_mask()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.update_by_slice_in_dim"><code class="docutils literal notranslate"><span class="pre">update_by_slice_in_dim()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.filter_topk_roadgraph_points"><code class="docutils literal notranslate"><span class="pre">filter_topk_roadgraph_points()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.is_road_edge"><code class="docutils literal notranslate"><span class="pre">is_road_edge()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.MapElementIds"><code class="docutils literal notranslate"><span class="pre">MapElementIds</span></code></a><ul>
<li><a class="reference internal" href="#waymax.datatypes.MapElementIds.LANE_UNDEFINED"><code class="docutils literal notranslate"><span class="pre">MapElementIds.LANE_UNDEFINED</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.MapElementIds.LANE_FREEWAY"><code class="docutils literal notranslate"><span class="pre">MapElementIds.LANE_FREEWAY</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.MapElementIds.LANE_SURFACE_STREET"><code class="docutils literal notranslate"><span class="pre">MapElementIds.LANE_SURFACE_STREET</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.MapElementIds.LANE_BIKE_LANE"><code class="docutils literal notranslate"><span class="pre">MapElementIds.LANE_BIKE_LANE</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.MapElementIds.ROAD_LINE_UNKNOWN"><code class="docutils literal notranslate"><span class="pre">MapElementIds.ROAD_LINE_UNKNOWN</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.MapElementIds.ROAD_LINE_BROKEN_SINGLE_WHITE"><code class="docutils literal notranslate"><span class="pre">MapElementIds.ROAD_LINE_BROKEN_SINGLE_WHITE</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.MapElementIds.ROAD_LINE_SOLID_SINGLE_WHITE"><code class="docutils literal notranslate"><span class="pre">MapElementIds.ROAD_LINE_SOLID_SINGLE_WHITE</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.MapElementIds.ROAD_LINE_SOLID_DOUBLE_WHITE"><code class="docutils literal notranslate"><span class="pre">MapElementIds.ROAD_LINE_SOLID_DOUBLE_WHITE</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.MapElementIds.ROAD_LINE_BROKEN_SINGLE_YELLOW"><code class="docutils literal notranslate"><span class="pre">MapElementIds.ROAD_LINE_BROKEN_SINGLE_YELLOW</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.MapElementIds.ROAD_LINE_BROKEN_DOUBLE_YELLOW"><code class="docutils literal notranslate"><span class="pre">MapElementIds.ROAD_LINE_BROKEN_DOUBLE_YELLOW</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.MapElementIds.ROAD_LINE_SOLID_SINGLE_YELLOW"><code class="docutils literal notranslate"><span class="pre">MapElementIds.ROAD_LINE_SOLID_SINGLE_YELLOW</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.MapElementIds.ROAD_LINE_SOLID_DOUBLE_YELLOW"><code class="docutils literal notranslate"><span class="pre">MapElementIds.ROAD_LINE_SOLID_DOUBLE_YELLOW</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.MapElementIds.ROAD_LINE_PASSING_DOUBLE_YELLOW"><code class="docutils literal notranslate"><span class="pre">MapElementIds.ROAD_LINE_PASSING_DOUBLE_YELLOW</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.MapElementIds.ROAD_EDGE_UNKNOWN"><code class="docutils literal notranslate"><span class="pre">MapElementIds.ROAD_EDGE_UNKNOWN</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.MapElementIds.ROAD_EDGE_BOUNDARY"><code class="docutils literal notranslate"><span class="pre">MapElementIds.ROAD_EDGE_BOUNDARY</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.MapElementIds.ROAD_EDGE_MEDIAN"><code class="docutils literal notranslate"><span class="pre">MapElementIds.ROAD_EDGE_MEDIAN</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.MapElementIds.STOP_SIGN"><code class="docutils literal notranslate"><span class="pre">MapElementIds.STOP_SIGN</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.MapElementIds.CROSSWALK"><code class="docutils literal notranslate"><span class="pre">MapElementIds.CROSSWALK</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.MapElementIds.SPEED_BUMP"><code class="docutils literal notranslate"><span class="pre">MapElementIds.SPEED_BUMP</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.MapElementIds.UNKNOWN"><code class="docutils literal notranslate"><span class="pre">MapElementIds.UNKNOWN</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#waymax.datatypes.RoadgraphPoints"><code class="docutils literal notranslate"><span class="pre">RoadgraphPoints</span></code></a><ul>
<li><a class="reference internal" href="#waymax.datatypes.RoadgraphPoints.x"><code class="docutils literal notranslate"><span class="pre">RoadgraphPoints.x</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.RoadgraphPoints.y"><code class="docutils literal notranslate"><span class="pre">RoadgraphPoints.y</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.RoadgraphPoints.z"><code class="docutils literal notranslate"><span class="pre">RoadgraphPoints.z</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.RoadgraphPoints.dir_x"><code class="docutils literal notranslate"><span class="pre">RoadgraphPoints.dir_x</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.RoadgraphPoints.dir_y"><code class="docutils literal notranslate"><span class="pre">RoadgraphPoints.dir_y</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.RoadgraphPoints.dir_z"><code class="docutils literal notranslate"><span class="pre">RoadgraphPoints.dir_z</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.RoadgraphPoints.types"><code class="docutils literal notranslate"><span class="pre">RoadgraphPoints.types</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.RoadgraphPoints.ids"><code class="docutils literal notranslate"><span class="pre">RoadgraphPoints.ids</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.RoadgraphPoints.valid"><code class="docutils literal notranslate"><span class="pre">RoadgraphPoints.valid</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.RoadgraphPoints.shape"><code class="docutils literal notranslate"><span class="pre">RoadgraphPoints.shape</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.RoadgraphPoints.num_points"><code class="docutils literal notranslate"><span class="pre">RoadgraphPoints.num_points</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.RoadgraphPoints.xy"><code class="docutils literal notranslate"><span class="pre">RoadgraphPoints.xy</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.RoadgraphPoints.xyz"><code class="docutils literal notranslate"><span class="pre">RoadgraphPoints.xyz</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.RoadgraphPoints.dir_xy"><code class="docutils literal notranslate"><span class="pre">RoadgraphPoints.dir_xy</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.RoadgraphPoints.dir_xyz"><code class="docutils literal notranslate"><span class="pre">RoadgraphPoints.dir_xyz</span></code></a></li>
<li><a class="reference internal" href="#id34"><code class="docutils literal notranslate"><span class="pre">RoadgraphPoints.x</span></code></a></li>
<li><a class="reference internal" href="#id35"><code class="docutils literal notranslate"><span class="pre">RoadgraphPoints.y</span></code></a></li>
<li><a class="reference internal" href="#id36"><code class="docutils literal notranslate"><span class="pre">RoadgraphPoints.z</span></code></a></li>
<li><a class="reference internal" href="#id37"><code class="docutils literal notranslate"><span class="pre">RoadgraphPoints.dir_x</span></code></a></li>
<li><a class="reference internal" href="#id38"><code class="docutils literal notranslate"><span class="pre">RoadgraphPoints.dir_y</span></code></a></li>
<li><a class="reference internal" href="#id39"><code class="docutils literal notranslate"><span class="pre">RoadgraphPoints.dir_z</span></code></a></li>
<li><a class="reference internal" href="#id40"><code class="docutils literal notranslate"><span class="pre">RoadgraphPoints.types</span></code></a></li>
<li><a class="reference internal" href="#id41"><code class="docutils literal notranslate"><span class="pre">RoadgraphPoints.ids</span></code></a></li>
<li><a class="reference internal" href="#id42"><code class="docutils literal notranslate"><span class="pre">RoadgraphPoints.valid</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.RoadgraphPoints.__eq__"><code class="docutils literal notranslate"><span class="pre">RoadgraphPoints.__eq__()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.RoadgraphPoints.validate"><code class="docutils literal notranslate"><span class="pre">RoadgraphPoints.validate()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#waymax.datatypes.Paths"><code class="docutils literal notranslate"><span class="pre">Paths</span></code></a><ul>
<li><a class="reference internal" href="#waymax.datatypes.Paths.x"><code class="docutils literal notranslate"><span class="pre">Paths.x</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Paths.y"><code class="docutils literal notranslate"><span class="pre">Paths.y</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Paths.z"><code class="docutils literal notranslate"><span class="pre">Paths.z</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Paths.ids"><code class="docutils literal notranslate"><span class="pre">Paths.ids</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Paths.valid"><code class="docutils literal notranslate"><span class="pre">Paths.valid</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Paths.arc_length"><code class="docutils literal notranslate"><span class="pre">Paths.arc_length</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Paths.on_route"><code class="docutils literal notranslate"><span class="pre">Paths.on_route</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Paths.shape"><code class="docutils literal notranslate"><span class="pre">Paths.shape</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Paths.num_points_per_path"><code class="docutils literal notranslate"><span class="pre">Paths.num_points_per_path</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Paths.num_paths"><code class="docutils literal notranslate"><span class="pre">Paths.num_paths</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Paths.xy"><code class="docutils literal notranslate"><span class="pre">Paths.xy</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Paths.xyz"><code class="docutils literal notranslate"><span class="pre">Paths.xyz</span></code></a></li>
<li><a class="reference internal" href="#id43"><code class="docutils literal notranslate"><span class="pre">Paths.x</span></code></a></li>
<li><a class="reference internal" href="#id44"><code class="docutils literal notranslate"><span class="pre">Paths.y</span></code></a></li>
<li><a class="reference internal" href="#id45"><code class="docutils literal notranslate"><span class="pre">Paths.z</span></code></a></li>
<li><a class="reference internal" href="#id46"><code class="docutils literal notranslate"><span class="pre">Paths.ids</span></code></a></li>
<li><a class="reference internal" href="#id47"><code class="docutils literal notranslate"><span class="pre">Paths.valid</span></code></a></li>
<li><a class="reference internal" href="#id48"><code class="docutils literal notranslate"><span class="pre">Paths.arc_length</span></code></a></li>
<li><a class="reference internal" href="#id49"><code class="docutils literal notranslate"><span class="pre">Paths.on_route</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Paths.__eq__"><code class="docutils literal notranslate"><span class="pre">Paths.__eq__()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.Paths.validate"><code class="docutils literal notranslate"><span class="pre">Paths.validate()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#waymax.datatypes.get_control_mask"><code class="docutils literal notranslate"><span class="pre">get_control_mask()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.SimulatorState"><code class="docutils literal notranslate"><span class="pre">SimulatorState</span></code></a><ul>
<li><a class="reference internal" href="#waymax.datatypes.SimulatorState.sim_trajectory"><code class="docutils literal notranslate"><span class="pre">SimulatorState.sim_trajectory</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.SimulatorState.log_trajectory"><code class="docutils literal notranslate"><span class="pre">SimulatorState.log_trajectory</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.SimulatorState.log_traffic_light"><code class="docutils literal notranslate"><span class="pre">SimulatorState.log_traffic_light</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.SimulatorState.object_metadata"><code class="docutils literal notranslate"><span class="pre">SimulatorState.object_metadata</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.SimulatorState.timestep"><code class="docutils literal notranslate"><span class="pre">SimulatorState.timestep</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.SimulatorState.sdc_paths"><code class="docutils literal notranslate"><span class="pre">SimulatorState.sdc_paths</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.SimulatorState.roadgraph_points"><code class="docutils literal notranslate"><span class="pre">SimulatorState.roadgraph_points</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.SimulatorState.shape"><code class="docutils literal notranslate"><span class="pre">SimulatorState.shape</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.SimulatorState.batch_dims"><code class="docutils literal notranslate"><span class="pre">SimulatorState.batch_dims</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.SimulatorState.num_objects"><code class="docutils literal notranslate"><span class="pre">SimulatorState.num_objects</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.SimulatorState.is_done"><code class="docutils literal notranslate"><span class="pre">SimulatorState.is_done</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.SimulatorState.remaining_timesteps"><code class="docutils literal notranslate"><span class="pre">SimulatorState.remaining_timesteps</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.SimulatorState.current_sim_trajectory"><code class="docutils literal notranslate"><span class="pre">SimulatorState.current_sim_trajectory</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.SimulatorState.current_log_trajectory"><code class="docutils literal notranslate"><span class="pre">SimulatorState.current_log_trajectory</span></code></a></li>
<li><a class="reference internal" href="#id50"><code class="docutils literal notranslate"><span class="pre">SimulatorState.sim_trajectory</span></code></a></li>
<li><a class="reference internal" href="#id51"><code class="docutils literal notranslate"><span class="pre">SimulatorState.log_trajectory</span></code></a></li>
<li><a class="reference internal" href="#id52"><code class="docutils literal notranslate"><span class="pre">SimulatorState.log_traffic_light</span></code></a></li>
<li><a class="reference internal" href="#id53"><code class="docutils literal notranslate"><span class="pre">SimulatorState.object_metadata</span></code></a></li>
<li><a class="reference internal" href="#id54"><code class="docutils literal notranslate"><span class="pre">SimulatorState.timestep</span></code></a></li>
<li><a class="reference internal" href="#id55"><code class="docutils literal notranslate"><span class="pre">SimulatorState.sdc_paths</span></code></a></li>
<li><a class="reference internal" href="#id56"><code class="docutils literal notranslate"><span class="pre">SimulatorState.roadgraph_points</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.SimulatorState.__eq__"><code class="docutils literal notranslate"><span class="pre">SimulatorState.__eq__()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.SimulatorState.validate"><code class="docutils literal notranslate"><span class="pre">SimulatorState.validate()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#waymax.datatypes.update_state_by_log"><code class="docutils literal notranslate"><span class="pre">update_state_by_log()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.TrafficLights"><code class="docutils literal notranslate"><span class="pre">TrafficLights</span></code></a><ul>
<li><a class="reference internal" href="#waymax.datatypes.TrafficLights.x"><code class="docutils literal notranslate"><span class="pre">TrafficLights.x</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.TrafficLights.y"><code class="docutils literal notranslate"><span class="pre">TrafficLights.y</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.TrafficLights.z"><code class="docutils literal notranslate"><span class="pre">TrafficLights.z</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.TrafficLights.state"><code class="docutils literal notranslate"><span class="pre">TrafficLights.state</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.TrafficLights.lane_ids"><code class="docutils literal notranslate"><span class="pre">TrafficLights.lane_ids</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.TrafficLights.valid"><code class="docutils literal notranslate"><span class="pre">TrafficLights.valid</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.TrafficLights.shape"><code class="docutils literal notranslate"><span class="pre">TrafficLights.shape</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.TrafficLights.num_traffic_lights"><code class="docutils literal notranslate"><span class="pre">TrafficLights.num_traffic_lights</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.TrafficLights.num_timesteps"><code class="docutils literal notranslate"><span class="pre">TrafficLights.num_timesteps</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.TrafficLights.xy"><code class="docutils literal notranslate"><span class="pre">TrafficLights.xy</span></code></a></li>
<li><a class="reference internal" href="#id57"><code class="docutils literal notranslate"><span class="pre">TrafficLights.x</span></code></a></li>
<li><a class="reference internal" href="#id58"><code class="docutils literal notranslate"><span class="pre">TrafficLights.y</span></code></a></li>
<li><a class="reference internal" href="#id59"><code class="docutils literal notranslate"><span class="pre">TrafficLights.z</span></code></a></li>
<li><a class="reference internal" href="#id60"><code class="docutils literal notranslate"><span class="pre">TrafficLights.state</span></code></a></li>
<li><a class="reference internal" href="#id61"><code class="docutils literal notranslate"><span class="pre">TrafficLights.lane_ids</span></code></a></li>
<li><a class="reference internal" href="#id62"><code class="docutils literal notranslate"><span class="pre">TrafficLights.valid</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.TrafficLights.__eq__"><code class="docutils literal notranslate"><span class="pre">TrafficLights.__eq__()</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.TrafficLights.validate"><code class="docutils literal notranslate"><span class="pre">TrafficLights.validate()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#waymax.datatypes.TrafficLightStates"><code class="docutils literal notranslate"><span class="pre">TrafficLightStates</span></code></a><ul>
<li><a class="reference internal" href="#waymax.datatypes.TrafficLightStates.UNKNOWN"><code class="docutils literal notranslate"><span class="pre">TrafficLightStates.UNKNOWN</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.TrafficLightStates.ARROW_STOP"><code class="docutils literal notranslate"><span class="pre">TrafficLightStates.ARROW_STOP</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.TrafficLightStates.ARROW_CAUTION"><code class="docutils literal notranslate"><span class="pre">TrafficLightStates.ARROW_CAUTION</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.TrafficLightStates.ARROW_GO"><code class="docutils literal notranslate"><span class="pre">TrafficLightStates.ARROW_GO</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.TrafficLightStates.STOP"><code class="docutils literal notranslate"><span class="pre">TrafficLightStates.STOP</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.TrafficLightStates.CAUTION"><code class="docutils literal notranslate"><span class="pre">TrafficLightStates.CAUTION</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.TrafficLightStates.GO"><code class="docutils literal notranslate"><span class="pre">TrafficLightStates.GO</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.TrafficLightStates.FLASHING_STOP"><code class="docutils literal notranslate"><span class="pre">TrafficLightStates.FLASHING_STOP</span></code></a></li>
<li><a class="reference internal" href="#waymax.datatypes.TrafficLightStates.FLASHING_CAUTION"><code class="docutils literal notranslate"><span class="pre">TrafficLightStates.FLASHING_CAUTION</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/scripts/furo.js"></script>
    <script src="../../../_static/design-tabs.js"></script>
    </body>
</html>
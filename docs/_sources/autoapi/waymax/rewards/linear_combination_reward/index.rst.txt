:py:mod:`waymax.rewards.linear_combination_reward`
==================================================

.. py:module:: waymax.rewards.linear_combination_reward

.. autoapi-nested-parse::

   Reward functions for the Waymax environment.



Module Contents
---------------

Classes
~~~~~~~

.. autoapisummary::

   waymax.rewards.linear_combination_reward.LinearCombinationReward



Functions
~~~~~~~~~

.. autoapisummary::

   waymax.rewards.linear_combination_reward._validate_reward_metrics
   waymax.rewards.linear_combination_reward._linear_config_to_metric_config



.. py:class:: LinearCombinationReward(config: waymax.config.LinearCombinationRewardConfig)


   Bases: :py:obj:`waymax.rewards.abstract_reward_function.AbstractRewardFunction`

   Reward function that performs a linear combination of metrics.

   .. py:method:: compute(simulator_state: waymax.datatypes.SimulatorState, action: waymax.datatypes.Action, agent_mask: jax.Array) -> jax.Array

      Computes the reward as a linear combination of metrics.

      :param simulator_state: State of the Waymax environment.
      :param action: Action taken to control the agent(s) (..., num_objects,
                     action_space).
      :param agent_mask: Binary mask indicating which agent inputs are valid (...,
                         num_objects).

      :returns: An array of rewards, where there is one reward per agent
                (..., num_objects).



.. py:function:: _validate_reward_metrics(config: waymax.config.LinearCombinationRewardConfig)

   Checks that all metrics in the RewardConfigs are valid.


.. py:function:: _linear_config_to_metric_config(config: waymax.config.LinearCombinationRewardConfig) -> waymax.config.MetricsConfig

   Converts a LinearCombinationRewardConfig into a MetricsConfig.



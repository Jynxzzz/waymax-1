:py:mod:`waymax.metrics.imitation`
==================================

.. py:module:: waymax.metrics.imitation

.. autoapi-nested-parse::

   Metrics relating to imitation.



Module Contents
---------------

Classes
~~~~~~~

.. autoapisummary::

   waymax.metrics.imitation.LogDivergenceMetric




.. py:class:: LogDivergenceMetric


   Bases: :py:obj:`waymax.metrics.abstract_metric.AbstractMetric`

   Log divergence metric.

   This metric returns the L2 distance between the controlled object's XY
   location and its position in the logged history at the same timestep.

   .. py:method:: compute(simulator_state: waymax.datatypes.SimulatorState) -> waymax.metrics.abstract_metric.MetricResult

      Computes log divergence by fetching correct arguments.

      :param simulator_state: The current simulator state.

      :returns: A (..., num_objects) MetricResult containing the metric result, with L2
                values representing the distance of each object from the log to the
                simulated trajectory at the current timestep.


   .. py:method:: compute_log_divergence(object_xy: jax.Array, log_xy: jax.Array) -> jax.Array
      :classmethod:

      Computes the L2 distance between `object_xy` and `log_xy`.

      :param object_xy: XY coordinates of current vehicles for the current timestep, of
                        shape (..., num_objects, num_timesteps, 2).
      :param log_xy: XY coordinates of logged vehicles for the current timestep, of
                     shape (..., num_objects, num_timesteps, 2).

      :returns:

                A (..., num_objects, num_timesteps) array containing the metric result of
                  the same shape as the input trajectories.



